!function(){"use strict";const e=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_handleResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}initialize(){return Promise.all([this.getUser(),this.getInitialCards()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>this._handleResponse(e)))}getUser(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then((e=>this._handleResponse(e)))}setUserInfo(e){let{name:t,about:s}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:s})}).then((e=>this._handleResponse(e)))}addCard(e){let{name:t,link:s}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})}).then((e=>this._handleResponse(e)))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>this._handleResponse(e)))}toggleLike(e,t){return fetch(`${this._baseUrl}/cards/likes/${e}`,{method:t?"DELETE":"PUT",headers:this._headers}).then((e=>this._handleResponse(e)))}updateAccountPic(e){let{avatar:t}=e;return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then((e=>this._handleResponse(e)))}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"099989f7-9742-46ef-99f8-aa8e6872a6c3","Content-Type":"application/json"}});class t{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this),this._closePopupOnRemoteClick=this._closePopupOnRemoteClick.bind(this)}open(){this._popup.classList.add("popup_open"),this._popup.addEventListener("mousedown",this._closePopupOnRemoteClick),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_open"),document.removeEventListener("keydown",this._handleEscClose),this._popup.removeEventListener("mousedown",this._closePopupOnRemoteClick)}_closePopupOnRemoteClick(e){e.target.classList.contains("popup__overlay")&&this.close()}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popup.querySelector(".popup__close-btn").addEventListener("click",(()=>this.close()))}}class s extends t{constructor(e,t,s){let{handleFormSubmit:n}=t,{loadingButtonText:r="Saving..."}=s;super(e),this._form=this._popup.querySelector(".popup__form"),this._handleFormSubmit=n,this._inputList=this._form.querySelectorAll(".popup__form-input"),this._saveButton=this._form.querySelector(".popup__button"),this._saveButtonText=this._saveButton.textContent,this._loadingButtonText=r}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}_getInputValues(){return this._objData={},this._inputList.forEach((e=>{this._objData[e.name]=e.value})),this._objData}setInputValues(e){this._objInput={},thisrenderSaving._inputList.forEach((t=>{this._objInput[t.name]=e[t.value]}))}close(){super.close(),this._form.reset()}open(){super.open()}renderSaving(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._loadingButtonText;this._saveButton.textContent=e?t:this._saveButtonText}}var n=class{constructor(e,t){this._form=t,this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._saveButtonSelector=e.saveButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._inputList=[...this._form.querySelectorAll(this._inputSelector)],this._buttonElement=this._form.querySelector(this._saveButtonSelector)}_showInputError(e,t){const s=this._form.querySelector(`.${e.id}-error`);e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`.${e.id}-error`);e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_setEventListeners(){this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.removeAttribute("disabled"))}enableValidation(){this._form.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}};const r=document.querySelector(".account__edit-button"),o=(document.querySelector(".account__name"),document.querySelector(".account__description"),document.querySelector(".popup__account-name")),i=document.querySelector(".popup__account-description"),a=document.querySelector(".popup__edit-form"),l=document.querySelector(".account__add-button"),c=(document.querySelector(".popup__place-name"),document.querySelector(".js-input-type-place-url"),document.querySelector(".popup__place-form")),u=document.querySelector(".account__image-edit-btn"),h=document.querySelector(".popup__edit-account-pic-form"),_=document.querySelector(".cards__list"),d={formSelector:".popup__form",inputSelector:".popup__form-input",saveButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input-type-error",errorClass:"popup__error_visible"};let p;const m=new class extends t{constructor(e,t){let{loadingButtonText:s="Saving..."}=t;super(e),this._form=this._popup.querySelector(".popup__form"),this._saveButton=this._form.querySelector(".popup__button"),this._saveButtonText=this._saveButton.textContent,this._loadingButtonText=s}open(e){this._handleSubmit=e,super.open()}close(){super.close()}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit()}))}renderSaving(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._loadingButtonText;this._saveButton.textContent=e?t:this._saveButtonText}}("#delete-popup",{loadingButtonText:"Deleting..."});m.setEventListeners();const v=e=>{const t=B(e);S.addItem(t)},S=new class{constructor(e,t){let{items:s,renderer:n}=e;this._renderedItems=s,this._renderer=n,this._container=t}addItem(e){this._container.prepend(e)}renderItems(e){e.forEach(this._renderer)}}({renderer:v},_),g=new class extends t{constructor(e){super(e),this._cardImage=document.querySelector(".popup__image-preview")}open(e,t){const s=this._cardImage;s.src=t,s.alt=e,document.querySelector(".popup__preview-name").textContent=e,super.open()}}("#view__image"),E=new s("#add__place",{handleFormSubmit:e=>{x(e)}},{loadingButtonText:"Saving..."});l.addEventListener("click",(()=>{E.open(),C.resetValidation()}));const b=new class{constructor(e){let{nameSelector:t,jobSelector:s,accountPicSelector:n}=e;this._name=document.querySelector(t),this._about=document.querySelector(s),this._accountPic=document.querySelector(n)}getUserInfo(){return{name:this._name.textContent,about:this._about.textContent}}setUserInfo(e){let{name:t,about:s}=e;this._name.textContent=t,this._about.textContent=s}setUserAvatar(e){let{avatar:t}=e;this._accountPic.src=t}}({nameSelector:".account__name",jobSelector:".account__description",accountPicSelector:".account__image"}),f=new s("#account__edit",{handleFormSubmit:e=>{q(e)}},{loadingButtonText:"Saving..."});r.addEventListener("click",(()=>{const{name:e,about:t}=b.getUserInfo();o.value=e,i.value=t,f.open(),y.resetValidation()}));const L=new s("#edit-account-pic-popup",{handleFormSubmit:e=>{w(e)}},{loadingButtonText:"Updating image..."});L.setEventListeners(),u.addEventListener("click",(()=>{L.open(),k.resetValidation()}));const y=new n(d,a),C=new n(d,c),k=new n(d,h);f.setEventListeners(),E.setEventListeners(),g.setEventListeners();const B=e=>{const t=new class{constructor(e,t,s,n,r,o){this.handleCardClick=s,this._handleDeleteButton=n,this._cardSelector=t,this._handleLikeButton=r,this._name=e.name,this._link=e.link,this._likes=e.likes,this._ownerId=e.owner._id,this._id=e._id,this._userId=o}updateLikes(e){this._likes=e,this._renderLikes()}isLiked(){return this._likes.some((e=>e._id===this._userId))}_renderLikes(){this._likesTotal.textContent=this._likes.length,this.isLiked()?this._cardElement.querySelector(".card__place-favorite").classList.add("card__place-favorite_active"):this._cardElement.querySelector(".card__place-favorite").classList.remove("card__place-favorite_active")}getCardId(){return this._id}_setEventListeners(){this._cardElement.querySelector(".card__place-favorite").addEventListener("click",this._handleLikeButton),this._trashButton.addEventListener("click",(()=>{this._handleDeleteButton(this._cardElement)})),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this.handleCardClick({link:this._link,name:this._name})}))}removeCard(){this._cardElement.remove(),this._cardElement=null}_getTemplate(){return document.querySelector(this._cardSelector).content.firstElementChild.cloneNode(!0)}getView(){this._cardElement=this._getTemplate(),this._cardElement.querySelector(".card__place-name").textContent=this._name;const e=this._cardElement.querySelector(".card__image");return this._likesTotal=this._cardElement.querySelector(".card__place-num"),this._trashButton=this._cardElement.querySelector(".card__trash"),this._setEventListeners(),this._renderLikes(),e.src=this._link,e.alt=this._name,this._ownerId!==this._userId&&this._trashButton.remove(),this._cardElement}}(e,"#card-template",(()=>{var t;t=e,g.open(t.name,t.link)}),(()=>{m.open((()=>{T(t)}))}),(()=>{I(t)}),p);return t.getView()},I=t=>{e.toggleLike(t.getCardId(),t.isLiked()).then((e=>{t.updateLikes(e.likes)})).catch((e=>{console.log(e)}))},q=t=>{f.renderSaving(!0),e.setUserInfo(t).then((e=>{b.setUserInfo({name:e.name,about:e.about}),f.close()})).catch((e=>{console.log(e)})).finally((()=>{f.renderSaving(!1)}))},x=t=>{E.renderSaving(!0),e.addCard(t).then((e=>{v(e),E.close()})).catch((e=>{console.log(e)})).finally((()=>{E.renderSaving(!1)}))},w=t=>{L.renderSaving(!0),e.updateAccountPic(t).then((e=>{b.setUserAvatar({avatar:e.avatar}),L.close()})).catch((e=>{console.log(e)})).finally((()=>{L.renderSaving(!1)}))},T=t=>{m.renderSaving(!0),e.deleteCard(t.getCardId()).then((()=>{t.removeCard(),m.close()})).catch((e=>{console.log(e)})).finally((()=>{m.renderSaving(!1)}))};e.initialize().then((e=>{let[t,s]=e;p=t._id,S.renderItems(s),b.setUserInfo({name:t.name,about:t.about}),b.setUserAvatar({avatar:t.avatar})})).catch((e=>{console.log(e)})),C.enableValidation(),y.enableValidation(),k.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TCxNQUFLWCxJQUNKd0gsRUFBV3hILEdBQ1g0SSxFQUFnQm5HLE9BQU8sSUFFeEJzSixPQUFNQyxJQUNMQyxRQUFRQyxJQUFJRixFQUFJLElBRWpCSSxTQUFRLEtBQ1B4RCxFQUFnQnBFLGNBQWEsRUFBTSxHQUNuQyxFQUVBb0YsRUFBcUIwQyxJQUN6QjNDLEVBQWtCbkYsY0FBYSxHQUMvQmhGLEVBQUFBLGlCQUNvQjhNLEdBQ2pCM0wsTUFBSzJMLElBQ0p2RCxFQUFTUSxjQUFjLENBQ3JCNUgsT0FBUTJLLEVBQWdCM0ssU0FFMUJnSSxFQUFrQmxILE9BQU8sSUFFMUJzSixPQUFNQyxJQUNMQyxRQUFRQyxJQUFJRixFQUFJLElBRWpCSSxTQUFRLEtBQ1B6QyxFQUFrQm5GLGNBQWEsRUFBTSxHQUNyQyxFQUVBcUgsRUFBMkI5QixJQUMvQjFDLEVBQWtCN0MsY0FBYSxHQUMvQmhGLEVBQUFBLFdBQ2N1SyxFQUFLcUIsYUFDaEJ6SyxNQUFLLEtBQ0pvSixFQUFLdUIsYUFDTGpFLEVBQWtCNUUsT0FBTyxJQUUxQnNKLE9BQU1DLElBQ0xDLFFBQVFDLElBQUlGLEVBQUksSUFFakJJLFNBQVEsS0FDUC9FLEVBQWtCN0MsY0FBYSxFQUFNLEdBQ3JDLEVBRU5oRixFQUFBQSxhQUVHbUIsTUFBSyxJQUF1QixJQUFyQjRMLEVBQU1DLEdBQVUsRUFDdEJwRixFQUFTbUYsRUFBSzNCLElBQ2RoRCxFQUFTVSxZQUFZa0UsR0FDckJ6RCxFQUFTbkksWUFBWSxDQUNuQkMsS0FBTTBMLEVBQUsxTCxLQUNYQyxNQUFPeUwsRUFBS3pMLFFBRWRpSSxFQUFTUSxjQUFjLENBQ3JCNUgsT0FBUTRLLEVBQUs1SyxRQUNiLElBRUhvSyxPQUFNQyxJQUNMQyxRQUFRQyxJQUFJRixFQUFJLElBR3BCbEQsRUFBb0JyQyxtQkFDcEJpRCxFQUFxQmpELG1CQUNyQm9ELEVBQXdCcEQsa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoVmVyaWZpY2F0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xuICB9XG5cbiAgX2hhbmRsZVJlc3BvbnNlKHJlcykge1xuICAgIHJldHVybiByZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gIH1cblxuICBpbml0aWFsaXplKCkge1xuICAgIHJldHVybiBQcm9taXNlLmFsbChbXG4gICAgICB0aGlzLmdldFVzZXIoKSwgXG4gICAgICB0aGlzLmdldEluaXRpYWxDYXJkcygpXG4gICAgXSk7XG4gICAgXG4gIH1cblxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX2hhbmRsZVJlc3BvbnNlKHJlcykpO1xuICB9XG5cbiAgZ2V0VXNlcigpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzKSk7XG4gIH1cblxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgIGFib3V0OiBhYm91dCxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzKSk7XG4gIH1cblxuICBhZGRDYXJkKHsgbmFtZSwgbGluayB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgIGxpbms6IGxpbmssXG4gICAgICB9KSxcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX2hhbmRsZVJlc3BvbnNlKHJlcykpO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX2hhbmRsZVJlc3BvbnNlKHJlcykpO1xuICB9XG5cbiAgdG9nZ2xlTGlrZShpZCwgaXNMaWtlZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2lkfWAsIHtcbiAgICAgIG1ldGhvZDogaXNMaWtlZCA/IFwiREVMRVRFXCIgOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX2hhbmRsZVJlc3BvbnNlKHJlcykpO1xuICB9XG4gIHVwZGF0ZUFjY291bnRQaWMoeyBhdmF0YXIgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGF2YXRhcixcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzKSk7XG4gIH1cblxuIFxufVxuXG5leHBvcnQgY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMlwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCIwOTk5ODlmNy05NzQyLTQ2ZWYtOTlmOC1hYThlNjg3MmE2YzNcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9jbG9zZVBvcHVwT25SZW1vdGVDbGljayA9IHRoaXMuX2Nsb3NlUG9wdXBPblJlbW90ZUNsaWNrLmJpbmQodGhpcyk7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuXCIpO1xuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5fY2xvc2VQb3B1cE9uUmVtb3RlQ2xpY2spO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICB0aGlzLl9wb3B1cC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2Nsb3NlUG9wdXBPblJlbW90ZUNsaWNrKTtcbiAgfVxuXG4gIF9jbG9zZVBvcHVwT25SZW1vdGVDbGljayhldnQpIHtcbiAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9fb3ZlcmxheVwiKSkge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Nsb3NlLWJ0blwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLmNsb3NlKCkpO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoXG4gICAgcG9wdXBTZWxlY3RvcixcbiAgICB7IGhhbmRsZUZvcm1TdWJtaXQgfSxcbiAgICB7IGxvYWRpbmdCdXR0b25UZXh0ID0gXCJTYXZpbmcuLi5cIiB9XG4gICkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9fZm9ybS1pbnB1dFwiKTtcbiAgICB0aGlzLl9zYXZlQnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19idXR0b25cIik7XG4gICAgdGhpcy5fc2F2ZUJ1dHRvblRleHQgPSB0aGlzLl9zYXZlQnV0dG9uLnRleHRDb250ZW50O1xuICAgIHRoaXMuX2xvYWRpbmdCdXR0b25UZXh0ID0gbG9hZGluZ0J1dHRvblRleHQ7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBldnQgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgIH0pO1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIHRoaXMuX29iakRhdGEgPSB7fTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaChpbnB1dCA9PiB7XG4gICAgICB0aGlzLl9vYmpEYXRhW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXMuX29iakRhdGE7XG4gIH1cblxuICBzZXRJbnB1dFZhbHVlcyhkYXRhKSB7XG4gICAgdGhpcy5fb2JqSW5wdXQgPSB7fTtcbiAgICB0aGlzcmVuZGVyU2F2aW5nLl9pbnB1dExpc3QuZm9yRWFjaChpbnB1dCA9PiB7XG4gICAgICB0aGlzLl9vYmpJbnB1dFtpbnB1dC5uYW1lXSA9IGRhdGFbaW5wdXQudmFsdWVdO1xuICAgIH0pO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxuXG4gIHJlbmRlclNhdmluZyhpc1NhdmluZywgbG9hZGluZ1RleHQgPSB0aGlzLl9sb2FkaW5nQnV0dG9uVGV4dCkge1xuICAgIGlmIChpc1NhdmluZykge1xuICAgICAgdGhpcy5fc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zYXZlQnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fc2F2ZUJ1dHRvblRleHQ7XG4gICAgfVxuICB9XG5cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5jbGFzcyBQb3B1cFdpdGhWZXJpZmljYXRpb24gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIHsgbG9hZGluZ0J1dHRvblRleHQgPSBcIlNhdmluZy4uLlwiIH0pIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcbiAgICB0aGlzLl9zYXZlQnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19idXR0b25cIik7XG4gICAgdGhpcy5fc2F2ZUJ1dHRvblRleHQgPSB0aGlzLl9zYXZlQnV0dG9uLnRleHRDb250ZW50O1xuICAgIHRoaXMuX2xvYWRpbmdCdXR0b25UZXh0ID0gbG9hZGluZ0J1dHRvblRleHQ7XG4gIH1cblxuICBvcGVuKGFjdGlvbikge1xuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGFjdGlvbjtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGV2dCA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCgpO1xuICAgIH0pO1xuICB9XG5cbiAgcmVuZGVyU2F2aW5nKGlzU2F2aW5nLCBsb2FkaW5nVGV4dCA9IHRoaXMuX2xvYWRpbmdCdXR0b25UZXh0KSB7XG4gICAgaWYgKGlzU2F2aW5nKSB7XG4gICAgICB0aGlzLl9zYXZlQnV0dG9uLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3NhdmVCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zYXZlQnV0dG9uVGV4dDtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoVmVyaWZpY2F0aW9uO1xuIiwiY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9mb3JtID0gZm9ybUVsZW1lbnQ7XG5cbiAgICB0aGlzLl9mb3JtU2VsZWN0b3IgPSB2YWxpZGF0aW9uU2V0dGluZ3MuZm9ybVNlbGVjdG9yO1xuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSB2YWxpZGF0aW9uU2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zYXZlQnV0dG9uU2VsZWN0b3IgPSB2YWxpZGF0aW9uU2V0dGluZ3Muc2F2ZUJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSB2YWxpZGF0aW9uU2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSB2YWxpZGF0aW9uU2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSB2YWxpZGF0aW9uU2V0dGluZ3MuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3NhdmVCdXR0b25TZWxlY3Rvcik7XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoaW5wdXRFbGVtZW50ID0+IHtcbiAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xuICAgIH0pO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goaW5wdXRFbGVtZW50ID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCB0cnVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKTtcbiAgICB9XG4gIH1cblxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGZ1bmN0aW9uKGV2dCkge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKGlucHV0RWxlbWVudCA9PiB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7IiwiZXhwb3J0IGNvbnN0IGVkaXRBY2NvdW50T3BlbkJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWNjb3VudF9fZWRpdC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgYWNjb3VudE5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWNjb3VudF9fbmFtZVwiKTtcbmV4cG9ydCBjb25zdCBhY2NvdW50VGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWNjb3VudF9fZGVzY3JpcHRpb25cIik7XG5leHBvcnQgY29uc3QgYWRkUG9wdXBTZWxlY3RvciA9IFwiI2FkZF9fcGxhY2VcIjtcbmV4cG9ydCBjb25zdCBlZGl0UG9wdXBTZWxlY3RvciA9IFwiI2FjY291bnRfX2VkaXRcIjtcbmV4cG9ydCBjb25zdCBhY2NvdW50TmFtZSA9IFwiLmFjY291bnRfX25hbWVcIjtcbmV4cG9ydCBjb25zdCBhY2NvdW50VGl0bGUgPSBcIi5hY2NvdW50X19kZXNjcmlwdGlvblwiO1xuXG5leHBvcnQgY29uc3QgcG9wdXBBY2NvdW50TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2FjY291bnQtbmFtZVwiKTtcbmV4cG9ydCBjb25zdCBwb3B1cEFjY291bnRJY29uc1RpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fYWNjb3VudC1kZXNjcmlwdGlvblwiKTtcbmV4cG9ydCBjb25zdCBhY2NvdW50UGljU2VsZWN0b3IgPSBcIi5hY2NvdW50X19pbWFnZVwiO1xuZXhwb3J0IGNvbnN0IHN1Ym1pdEFjY291bnRFZGl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZWRpdC1mb3JtXCIpO1xuZXhwb3J0IGNvbnN0IGFkZFBsYWNlc09wZW5CdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFjY291bnRfX2FkZC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgcG9wdXBQbGFjZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19wbGFjZS1uYW1lXCIpO1xuZXhwb3J0IGNvbnN0IHBvcHVwUGxhY2VVcmwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmpzLWlucHV0LXR5cGUtcGxhY2UtdXJsXCIpO1xuZXhwb3J0IGNvbnN0IHN1Ym1pdE5ld1BsYWNlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fcGxhY2UtZm9ybVwiKTtcbmV4cG9ydCBjb25zdCBlZGl0QWNjb3VudFBpY0J1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWNjb3VudF9faW1hZ2UtZWRpdC1idG5cIik7XG5leHBvcnQgY29uc3Qgc3VibWl0TmV3QWNjb3VudFBpYyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2VkaXQtYWNjb3VudC1waWMtZm9ybVwiKTtcblxuLy8gQ2FyZHMgTGlzdCBcbmV4cG9ydCBjb25zdCBwbGFjZUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xuXG5cbi8vIFBsYWNlIENhcmRzXG5leHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJSZWFjaGluZyBmb3IgdGhlIE1vb25cIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaS5waW5pbWcuY29tLzU2NHgvODgvOWIvMzYvODg5YjM2MDdiMmI5MzQzMGI0MGQ3ZjAzYWU5MThlOGQuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlBvcnRyYWl0IG9mIEJhcmJhcmEgb2YgUG9ydHVnYWxcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaS5waW5pbWcuY29tLzU2NHgvOGEvYTAvNzAvOGFhMDcwNTMxNzhjYjFiYmI0YTNmOTMzNzlkNzUwZDIuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlNpbWVyZW55YVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9pLnBpbmltZy5jb20vNTY0eC80Ni82Ni8zMC80NjY2MzA1MGUzODg1NTBiZjI0YjgwODYxNzk2MjcxZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQ3VwaWQgYW5kIFBzeWNoZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9pLnBpbmltZy5jb20vNTY0eC8xNi9lMi84Yi8xNmUyOGJiYjQ4ODA4NWNmNWRmNjlmNjJjMDc3OTFjYi5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiU3RyZWV0IGluIHRoZSBFdmVuaW5nLCBQcmFndWVcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaS5waW5pbWcuY29tLzU2NHgvZmUvODUvM2IvZmU4NTNiMTJlZTUyOTBhNGIwOTY3ZWM2ZTIwZGU3ODIuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkdpcmwgYXQgdGhlIFBpYW5vXCIsXG4gICAgbGluazogXCJodHRwczovL2kucGluaW1nLmNvbS81NjR4L2Q3LzBiLzUzL2Q3MGI1MzQ3OTFmNTBmNjJlNzQxNjY5YWVjZDdhNDc5LmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJHb2luZyBIb21lXCIsXG4gICAgbGluazogXCJodHRwczovL2kucGluaW1nLmNvbS81NjR4L2FkLzUzLzJiL2FkNTMyYjMxYmJmY2QwMDZjNmI4ZjMzYTliNGNlYmYzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJSYWlueSBOaWdodFwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9pLnBpbmltZy5jb20vNTY0eC8xYS81MC8zMi8xYTUwMzIxYjkwNWI1ZGRkNjBiMjgwMmMxYjUwYWQ0Yi5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVGhlIFNwcmVhZGluZyBUcmVlXCIsXG4gICAgbGluazogXCJodHRwczovL2kucGluaW1nLmNvbS81NjR4L2Q2L2IyL2Y5L2Q2YjJmOTQ2NTc5N2M0YWRlYzVmY2E2NDFhMWRkMmQ4LmpwZ1wiLFxuICB9LFxuXTtcblxuLy8gVmFsaWRhdG9ycyBcblxuZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25TZXR0aW5ncyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5wb3B1cF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9fZm9ybS1pbnB1dFwiLFxuICBzYXZlQnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cF9fYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXQtdHlwZS1lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcInBvcHVwX19lcnJvcl92aXNpYmxlXCJcbn07XG5cblxuIiwiLy8gSW5kZXggQ1NTIEltcG9ydFxuXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiOyBcbiBcbi8vIEpTIEltcG9ydHMgXG5pbXBvcnQgeyBhcGkgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjsgXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7IFxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiOyBcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiOyBcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjsgXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjsgXG5pbXBvcnQgUG9wdXBXaXRoVmVyaWZpY2F0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aFZlcmlmaWNhdGlvbi5qc1wiOyBcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjsgXG5pbXBvcnQgeyBcbiAgZWRpdEFjY291bnRPcGVuQnRuLCBcbiAgYWNjb3VudE5hbWUsIFxuICBhY2NvdW50VGl0bGUsIFxuICBzdWJtaXRBY2NvdW50RWRpdCwgXG4gIGFkZFBsYWNlc09wZW5CdG4sIFxuICBlZGl0QWNjb3VudFBpY0J1dHRvbiwgXG4gIGFjY291bnRQaWNTZWxlY3RvciwgXG4gIHBvcHVwUGxhY2VOYW1lLCBcbiAgcG9wdXBQbGFjZVVybCwgXG4gIHBvcHVwQWNjb3VudE5hbWUsIFxuICBzdWJtaXROZXdBY2NvdW50UGljLCBcbiAgYWNjb3VudE5hbWVJbnB1dCwgXG4gIHBvcHVwQWNjb3VudEljb25zVGl0bGUsIFxuICBhY2NvdW50VGl0bGVJbnB1dCwgXG4gIHN1Ym1pdE5ld1BsYWNlLCBcbiAgZWRpdFBvcHVwU2VsZWN0b3IsIFxuICBwbGFjZUxpc3QsXG5cbiAgYWRkUG9wdXBTZWxlY3RvciwgXG4gIHZhbGlkYXRpb25TZXR0aW5nc1xuXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjsgXG5cbmxldCB1c2VySWQ7IFxuXG5cbi8vIENhcmQgRnVuY3Rpb25zIFxuY29uc3QgY29uZmlybWF0aW9uUG9wdXAgPSBuZXcgUG9wdXBXaXRoVmVyaWZpY2F0aW9uKFwiI2RlbGV0ZS1wb3B1cFwiLCB7IFxuICBsb2FkaW5nQnV0dG9uVGV4dDogXCJEZWxldGluZy4uLlwiIFxufSk7IFxuY29uZmlybWF0aW9uUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTsgXG5cbiBcbmNvbnN0IHJlbmRlckNhcmQgPSBjYXJkRGF0YVBsYWNlSG9sZGVyID0+IHsgXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChjYXJkRGF0YVBsYWNlSG9sZGVyKTsgXG4gIGNhcmRMaXN0LmFkZEl0ZW0oY2FyZEVsZW1lbnQpOyBcbn07IFxuIFxuY29uc3QgY2FyZExpc3QgPSBuZXcgU2VjdGlvbiggXG4gIHsgXG4gICAgcmVuZGVyZXI6IHJlbmRlckNhcmQgXG4gIH0sIFxuICBwbGFjZUxpc3QgXG4pOyBcbiBcbiBcbmNvbnN0IHByZXZpZXdJbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI3ZpZXdfX2ltYWdlXCIpOyBcbmNvbnN0IGhhbmRsZUNhcmRDbGljayA9IGl0ZW0gPT4geyBcbiAgcHJldmlld0ltYWdlUG9wdXAub3BlbihpdGVtLm5hbWUsIGl0ZW0ubGluayk7IFxufTsgXG4gXG5jb25zdCBhZGROZXdDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSggXG4gIGFkZFBvcHVwU2VsZWN0b3IsIFxuICB7IFxuICAgIGhhbmRsZUZvcm1TdWJtaXQ6IGRhdGEgPT4geyBcbiAgICAgIGFkZEFDYXJkKGRhdGEpOyBcbiAgICB9IFxuICB9LCBcbiAgeyBcbiAgICBsb2FkaW5nQnV0dG9uVGV4dDogXCJTYXZpbmcuLi5cIiBcbiB9IFxuKTsgXG4gXG5hZGRQbGFjZXNPcGVuQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7IFxuIGFkZE5ld0NhcmRQb3B1cC5vcGVuKCk7IFxuICBwbGFjZXNGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpOyBcbn0pOyBcbiBcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHsgXG4gIG5hbWVTZWxlY3RvcjogYWNjb3VudE5hbWUsIFxuICBqb2JTZWxlY3RvcjogYWNjb3VudFRpdGxlLCBcbiAgYWNjb3VudFBpY1NlbGVjdG9yOiBhY2NvdW50UGljU2VsZWN0b3IgXG59KTsgXG4gXG4vLyBQb3B1cCBGdW5jdGlvbnMgXG5jb25zdCBlZGl0Rm9ybVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oIFxuICBlZGl0UG9wdXBTZWxlY3RvciwgXG4gIHsgXG4gICAgaGFuZGxlRm9ybVN1Ym1pdDogZGF0YSA9PiB7IFxuICAgICAgZWRpdEFjY291bnQoZGF0YSk7IFxuICAgIH0gXG4gIH0sIFxuICB7IFxuICAgIGxvYWRpbmdCdXR0b25UZXh0OiBcIlNhdmluZy4uLlwiIFxuICB9IFxuKTsgXG5lZGl0QWNjb3VudE9wZW5CdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHsgXG4gIGNvbnN0IHsgbmFtZSwgYWJvdXQgfSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7IFxuICBwb3B1cEFjY291bnROYW1lLnZhbHVlID0gbmFtZTsgXG4gIHBvcHVwQWNjb3VudEljb25zVGl0bGUudmFsdWUgPSBhYm91dDsgXG5cbiAgZWRpdEZvcm1Qb3B1cC5vcGVuKCk7IFxuICBhY2NvdW50Rm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTsgXG59KTsgXG5jb25zdCBlZGl0UG9maWxlUGljRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKCBcbiAgXCIjZWRpdC1hY2NvdW50LXBpYy1wb3B1cFwiLCBcbiAgeyBcbiAgICBoYW5kbGVGb3JtU3VibWl0OiBkYXRhID0+IHsgXG4gICAgICBjaGFuZ2VBY2NvdW50SW1hZ2UoZGF0YSk7IFxuICAgIH0gXG4gIH0sIFxuICB7IFxuICAgIGxvYWRpbmdCdXR0b25UZXh0OiBcIlVwZGF0aW5nIGltYWdlLi4uXCIgXG4gIH0gXG4pOyBcbiBcbmVkaXRQb2ZpbGVQaWNGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7IFxuZWRpdEFjY291bnRQaWNCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHsgXG4gIGVkaXRQb2ZpbGVQaWNGb3JtLm9wZW4oKTsgXG4gIGFjY291bnRQaWNGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpOyBcbn0pOyBcbiBcbmNvbnN0IGFjY291bnRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoIFxuICB2YWxpZGF0aW9uU2V0dGluZ3MsIFxuICBzdWJtaXRBY2NvdW50RWRpdCBcbik7IFxuY29uc3QgcGxhY2VzRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgc3VibWl0TmV3UGxhY2UpOyBcbiBcbmNvbnN0IGFjY291bnRQaWNGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoIFxuICB2YWxpZGF0aW9uU2V0dGluZ3MsIFxuICBzdWJtaXROZXdBY2NvdW50UGljIFxuKTsgXG4gXG5lZGl0Rm9ybVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7IFxuYWRkTmV3Q2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7IFxuIFxucHJldmlld0ltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTsgXG4gXG5jb25zdCBjcmVhdGVDYXJkID0gY2FyZERhdGFQbGFjZUhvbGRlciA9PiB7IFxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoIFxuICAgIGNhcmREYXRhUGxhY2VIb2xkZXIsIFxuICAgIFwiI2NhcmQtdGVtcGxhdGVcIiwgXG4gICAgKCkgPT4geyBcblxuICAgICAgaGFuZGxlQ2FyZENsaWNrKGNhcmREYXRhUGxhY2VIb2xkZXIpO1xuICAgIH0sIFxuICAgICgpID0+IHsgXG4gICAgICBjb25maXJtYXRpb25Qb3B1cC5vcGVuKCgpID0+IHtcbiAgICAgICAgaGFuZGxlRGVsZXRlQ29uZmlybWF0aW9uKGNhcmQpOyBcbiAgICAgIH0pOyBcbiAgICB9LCBcbiAgICAoKSA9PiB7IFxuICAgICAgdG9nZ2xlTGlrZShjYXJkKTsgXG4gICAgfSwgXG4gICAgdXNlcklkIFxuICApOyBcbiAgcmV0dXJuIGNhcmQuZ2V0VmlldygpOyBcbn07IFxuIFxuY29uc3QgdG9nZ2xlTGlrZSA9IGNhcmRQbGFjZWhvbGRlciA9PiB7IFxuICBhcGkgXG4gICAgLnRvZ2dsZUxpa2UoY2FyZFBsYWNlaG9sZGVyLmdldENhcmRJZCgpLCBjYXJkUGxhY2Vob2xkZXIuaXNMaWtlZCgpKSBcbiAgICAudGhlbihsaWtlcyA9PiB7IFxuICAgICAgY2FyZFBsYWNlaG9sZGVyLnVwZGF0ZUxpa2VzKGxpa2VzLmxpa2VzKTsgXG4gICAgfSkgXG4gICAgLmNhdGNoKGVyciA9PiB7IFxuICAgICAgY29uc29sZS5sb2coZXJyKTsgXG4gICAgfSk7IFxufTsgXG5jb25zdCBlZGl0QWNjb3VudCA9IGFjY291bnREYXRhID0+IHsgXG4gIGVkaXRGb3JtUG9wdXAucmVuZGVyU2F2aW5nKHRydWUpOyBcbiAgYXBpIFxuICAgIC5zZXRVc2VySW5mbyhhY2NvdW50RGF0YSkgXG4gICAgLnRoZW4oYWNjb3VudERhdGEgPT4geyBcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHsgXG4gICAgICAgIG5hbWU6IGFjY291bnREYXRhLm5hbWUsIFxuICAgICAgICBhYm91dDogYWNjb3VudERhdGEuYWJvdXQgXG4gICAgICB9KTsgXG4gICAgICBlZGl0Rm9ybVBvcHVwLmNsb3NlKCk7IFxuICAgIH0pIFxuICAgIC5jYXRjaChlcnIgPT4geyBcbiAgICAgIGNvbnNvbGUubG9nKGVycik7IFxuICAgIH0pIFxuICAgIC5maW5hbGx5KCgpID0+IHsgXG4gICAgICBlZGl0Rm9ybVBvcHVwLnJlbmRlclNhdmluZyhmYWxzZSk7IFxuICAgIH0pOyBcbn07IFxuY29uc3QgYWRkQUNhcmQgPSBjYXJkRGF0YVBsYWNlaG9sZGVyID0+IHsgXG4gIGFkZE5ld0NhcmRQb3B1cC5yZW5kZXJTYXZpbmcodHJ1ZSk7IFxuICBhcGkgXG4gICAgLmFkZENhcmQoY2FyZERhdGFQbGFjZWhvbGRlcikgXG4gICAgLnRoZW4ocmVzID0+IHsgXG4gICAgICByZW5kZXJDYXJkKHJlcyk7IFxuICAgICAgYWRkTmV3Q2FyZFBvcHVwLmNsb3NlKCk7IFxuICAgIH0pIFxuICAgIC5jYXRjaChlcnIgPT4geyBcbiAgICAgIGNvbnNvbGUubG9nKGVycik7IFxuICAgIH0pIFxuICAgIC5maW5hbGx5KCgpID0+IHsgXG4gICAgICBhZGROZXdDYXJkUG9wdXAucmVuZGVyU2F2aW5nKGZhbHNlKTsgXG4gICAgfSk7IFxufTsgXG5jb25zdCBjaGFuZ2VBY2NvdW50SW1hZ2UgPSBhY2NvdW50SW1hZ2VVcmwgPT4geyBcbiAgZWRpdFBvZmlsZVBpY0Zvcm0ucmVuZGVyU2F2aW5nKHRydWUpOyBcbiAgYXBpIFxuICAgIC51cGRhdGVBY2NvdW50UGljKGFjY291bnRJbWFnZVVybCkgXG4gICAgLnRoZW4oYWNjb3VudEltYWdlVXJsID0+IHsgXG4gICAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKHsgXG4gICAgICAgIGF2YXRhcjogYWNjb3VudEltYWdlVXJsLmF2YXRhciBcbiAgICAgIH0pOyBcbiAgICAgIGVkaXRQb2ZpbGVQaWNGb3JtLmNsb3NlKCk7IFxuICAgIH0pIFxuICAgIC5jYXRjaChlcnIgPT4geyBcbiAgICAgIGNvbnNvbGUubG9nKGVycik7IFxuICAgIH0pIFxuICAgIC5maW5hbGx5KCgpID0+IHsgXG4gICAgICBlZGl0UG9maWxlUGljRm9ybS5yZW5kZXJTYXZpbmcoZmFsc2UpOyBcbiAgICB9KTsgXG59OyBcbmNvbnN0IGhhbmRsZURlbGV0ZUNvbmZpcm1hdGlvbiA9IGNhcmQgPT4geyBcbiAgY29uZmlybWF0aW9uUG9wdXAucmVuZGVyU2F2aW5nKHRydWUpOyBcbiAgYXBpIFxuICAgIC5kZWxldGVDYXJkKGNhcmQuZ2V0Q2FyZElkKCkpIFxuICAgIC50aGVuKCgpID0+IHsgXG4gICAgICBjYXJkLnJlbW92ZUNhcmQoKTsgXG4gICAgICBjb25maXJtYXRpb25Qb3B1cC5jbG9zZSgpOyBcbiAgICB9KSBcbiAgICAuY2F0Y2goZXJyID0+IHsgXG4gICAgICBjb25zb2xlLmxvZyhlcnIpOyBcbiAgICB9KSBcbiAgICAuZmluYWxseSgoKSA9PiB7IFxuICAgICAgY29uZmlybWF0aW9uUG9wdXAucmVuZGVyU2F2aW5nKGZhbHNlKTsgXG4gICAgfSk7IFxufTsgXG5hcGkgXG4gIC5pbml0aWFsaXplKCkgXG4gIC50aGVuKChbdXNlciwgY2FyZHNEYXRhXSkgPT4geyBcbiAgICB1c2VySWQgPSB1c2VyLl9pZDsgXG4gICAgY2FyZExpc3QucmVuZGVySXRlbXMoY2FyZHNEYXRhKTsgXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oeyBcbiAgICAgIG5hbWU6IHVzZXIubmFtZSwgXG4gICAgICBhYm91dDogdXNlci5hYm91dCBcbiAgICB9KTsgXG4gICAgdXNlckluZm8uc2V0VXNlckF2YXRhcih7IFxuICAgICAgYXZhdGFyOiB1c2VyLmF2YXRhciBcbiAgICB9KTsgXG4gIH0pIFxuICAuY2F0Y2goZXJyID0+IHsgXG4gICAgY29uc29sZS5sb2coZXJyKTsgXG4gIH0pOyBcbiBcbnBsYWNlc0Zvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpOyBcbmFjY291bnRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTsgXG5hY2NvdW50UGljRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7ICIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXIpIHtcbiAgICB0aGlzLl9yZW5kZXJlZEl0ZW1zID0gaXRlbXM7IFxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gY29udGFpbmVyO1xuICB9XG5cbiAgYWRkSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XG4gIH1cblxuICByZW5kZXJJdGVtcyhpdGVtcykge1xuICAgIGl0ZW1zLmZvckVhY2godGhpcy5fcmVuZGVyZXIpO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZS1wcmV2aWV3XCIpO1xuICB9XG4gIG9wZW4obmFtZSwgbGluaykge1xuICAgIGNvbnN0IGltYWdlRWxlbWVudCA9IHRoaXMuX2NhcmRJbWFnZTtcbiAgICBpbWFnZUVsZW1lbnQuc3JjID0gbGluaztcbiAgICBpbWFnZUVsZW1lbnQuYWx0ID0gbmFtZTtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIucG9wdXBfX3ByZXZpZXctbmFtZVwiXG4gICAgKS50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEltYWdlO1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IsYWNjb3VudFBpY1NlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9uYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX2Fib3V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XG4gICAgdGhpcy5fYWNjb3VudFBpYyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYWNjb3VudFBpY1NlbGVjdG9yKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7IFxuICAgICAgbmFtZTogdGhpcy5fbmFtZS50ZXh0Q29udGVudCwgXG4gICAgICBhYm91dDogdGhpcy5fYWJvdXQudGV4dENvbnRlbnQgXG4gICAgfVxuICB9XG5cbiAgc2V0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XG4gICAgdGhpcy5fbmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgdGhpcy5fYWJvdXQudGV4dENvbnRlbnQgPSBhYm91dDtcbiAgfVxuXG4gIHNldFVzZXJBdmF0YXIoe2F2YXRhcn0pe1xuICAgIHRoaXMuX2FjY291bnRQaWMuc3JjID0gYXZhdGFyO1xuICB9XG59XG4iLCJjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoXG4gICAgZGF0YSxcbiAgICBjYXJkU2VsZWN0b3IsXG4gICAgaGFuZGxlQ2FyZENsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUJ1dHRvbixcbiAgICBoYW5kbGVMaWtlQnV0dG9uLFxuICAgIHVzZXJJZFxuICApIHtcbiAgICB0aGlzLmhhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVCdXR0b24gPSBoYW5kbGVEZWxldGVCdXR0b247XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VCdXR0b24gPSBoYW5kbGVMaWtlQnV0dG9uO1xuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XG4gICAgdGhpcy5fb3duZXJJZCA9IGRhdGEub3duZXIuX2lkO1xuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xuICB9XG5cbiAgdXBkYXRlTGlrZXMobGlrZXMpIHtcbiAgICB0aGlzLl9saWtlcyA9IGxpa2VzO1xuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XG4gIH1cblxuICBpc0xpa2VkKCkge1xuICAgIHJldHVybiB0aGlzLl9saWtlcy5zb21lKGxpa2UgPT4gbGlrZS5faWQgPT09IHRoaXMuX3VzZXJJZCk7XG4gIH1cblxuICBfcmVuZGVyTGlrZXMoKSB7XG4gICAgdGhpcy5fbGlrZXNUb3RhbC50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcbiAgICBpZiAodGhpcy5pc0xpa2VkKCkpIHtcbiAgICAgIHRoaXMuX2NhcmRFbGVtZW50XG4gICAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3BsYWNlLWZhdm9yaXRlXCIpXG4gICAgICAgIC5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fcGxhY2UtZmF2b3JpdGVfYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19wbGFjZS1mYXZvcml0ZVwiKVxuICAgICAgICAuY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX3BsYWNlLWZhdm9yaXRlX2FjdGl2ZVwiKTtcbiAgICB9XG4gIH1cblxuICBnZXRDYXJkSWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lkO1xuICB9XG4gIC8vcnVucyAzcmRcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19wbGFjZS1mYXZvcml0ZVwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKTtcblxuICAgIHRoaXMuX3RyYXNoQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVCdXR0b24odGhpcy5fY2FyZEVsZW1lbnQpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5oYW5kbGVDYXJkQ2xpY2soeyBsaW5rOiB0aGlzLl9saW5rLCBuYW1lOiB0aGlzLl9uYW1lIH0pO1xuICAgICAgfSk7XG4gIH1cblxuICByZW1vdmVDYXJkKCkgeyBcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTsgXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsXG59IFxuXG4gIC8vcnVucyAybmRcbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIHJldHVybiBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQuY2xvbmVOb2RlKHRydWUpOyAvLy9fZ2V0VGVtcGxhdGVcbiAgfVxuICAvL3J1bnMgMXN0XG4gIGdldFZpZXcoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5jYXJkX19wbGFjZS1uYW1lXCJcbiAgICApLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICBjb25zdCBpbWFnZUVsZW1lbnQgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2xpa2VzVG90YWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3BsYWNlLW51bVwiKTtcbiAgICB0aGlzLl90cmFzaEJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdHJhc2hcIik7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xuICAgIGltYWdlRWxlbWVudC5zcmMgPSB0aGlzLl9saW5rO1xuICAgIGltYWdlRWxlbWVudC5hbHQgPSB0aGlzLl9uYW1lO1xuICAgIGlmICh0aGlzLl9vd25lcklkICE9PSB0aGlzLl91c2VySWQpIHtcbiAgICAgIHRoaXMuX3RyYXNoQnV0dG9uLnJlbW92ZSgpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQ2FyZDtcbiJdLCJuYW1lcyI6WyJhcGkiLCJjb25zdHJ1Y3RvciIsImJhc2VVcmwiLCJoZWFkZXJzIiwidGhpcyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfaGFuZGxlUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiaW5pdGlhbGl6ZSIsImFsbCIsImdldFVzZXIiLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsInRoZW4iLCJzZXRVc2VySW5mbyIsIm5hbWUiLCJhYm91dCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWRkQ2FyZCIsImxpbmsiLCJkZWxldGVDYXJkIiwiY2FyZElkIiwidG9nZ2xlTGlrZSIsImlkIiwiaXNMaWtlZCIsInVwZGF0ZUFjY291bnRQaWMiLCJhdmF0YXIiLCJhdXRob3JpemF0aW9uIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIl9jbG9zZVBvcHVwT25SZW1vdGVDbGljayIsIm9wZW4iLCJjbGFzc0xpc3QiLCJhZGQiLCJhZGRFdmVudExpc3RlbmVyIiwiY2xvc2UiLCJyZW1vdmUiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0IiwidGFyZ2V0IiwiY29udGFpbnMiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0IiwibG9hZGluZ0J1dHRvblRleHQiLCJzdXBlciIsIl9mb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfaW5wdXRMaXN0IiwicXVlcnlTZWxlY3RvckFsbCIsIl9zYXZlQnV0dG9uIiwiX3NhdmVCdXR0b25UZXh0IiwidGV4dENvbnRlbnQiLCJfbG9hZGluZ0J1dHRvblRleHQiLCJwcmV2ZW50RGVmYXVsdCIsIl9nZXRJbnB1dFZhbHVlcyIsIl9vYmpEYXRhIiwiZm9yRWFjaCIsImlucHV0IiwidmFsdWUiLCJzZXRJbnB1dFZhbHVlcyIsImRhdGEiLCJfb2JqSW5wdXQiLCJ0aGlzcmVuZGVyU2F2aW5nIiwicmVzZXQiLCJyZW5kZXJTYXZpbmciLCJpc1NhdmluZyIsImxvYWRpbmdUZXh0IiwidmFsaWRhdGlvblNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfZm9ybVNlbGVjdG9yIiwiZm9ybVNlbGVjdG9yIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3NhdmVCdXR0b25TZWxlY3RvciIsInNhdmVCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfYnV0dG9uRWxlbWVudCIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZSIsImVycm9yRWxlbWVudCIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGFzSW52YWxpZElucHV0Iiwic29tZSIsIl9zZXRFdmVudExpc3RlbmVycyIsIl90b2dnbGVCdXR0b25TdGF0ZSIsInNldEF0dHJpYnV0ZSIsInJlbW92ZUF0dHJpYnV0ZSIsImVuYWJsZVZhbGlkYXRpb24iLCJyZXNldFZhbGlkYXRpb24iLCJlZGl0QWNjb3VudE9wZW5CdG4iLCJwb3B1cEFjY291bnROYW1lIiwicG9wdXBBY2NvdW50SWNvbnNUaXRsZSIsInN1Ym1pdEFjY291bnRFZGl0IiwiYWRkUGxhY2VzT3BlbkJ0biIsInN1Ym1pdE5ld1BsYWNlIiwiZWRpdEFjY291bnRQaWNCdXR0b24iLCJzdWJtaXROZXdBY2NvdW50UGljIiwicGxhY2VMaXN0IiwidXNlcklkIiwiY29uZmlybWF0aW9uUG9wdXAiLCJhY3Rpb24iLCJfaGFuZGxlU3VibWl0IiwicmVuZGVyQ2FyZCIsImNhcmREYXRhUGxhY2VIb2xkZXIiLCJjYXJkRWxlbWVudCIsImNyZWF0ZUNhcmQiLCJjYXJkTGlzdCIsImFkZEl0ZW0iLCJjb250YWluZXIiLCJpdGVtcyIsInJlbmRlcmVyIiwiX3JlbmRlcmVkSXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiZWxlbWVudCIsInByZXBlbmQiLCJyZW5kZXJJdGVtcyIsInByZXZpZXdJbWFnZVBvcHVwIiwiX2NhcmRJbWFnZSIsImltYWdlRWxlbWVudCIsInNyYyIsImFsdCIsImFkZE5ld0NhcmRQb3B1cCIsImFkZEFDYXJkIiwicGxhY2VzRm9ybVZhbGlkYXRvciIsInVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJhY2NvdW50UGljU2VsZWN0b3IiLCJfbmFtZSIsIl9hYm91dCIsIl9hY2NvdW50UGljIiwiZ2V0VXNlckluZm8iLCJzZXRVc2VyQXZhdGFyIiwiZWRpdEZvcm1Qb3B1cCIsImVkaXRBY2NvdW50IiwiYWNjb3VudEZvcm1WYWxpZGF0b3IiLCJlZGl0UG9maWxlUGljRm9ybSIsImNoYW5nZUFjY291bnRJbWFnZSIsImFjY291bnRQaWNGb3JtVmFsaWRhdG9yIiwiRm9ybVZhbGlkYXRvciIsImNhcmQiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVEZWxldGVCdXR0b24iLCJoYW5kbGVMaWtlQnV0dG9uIiwiX2hhbmRsZURlbGV0ZUJ1dHRvbiIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlTGlrZUJ1dHRvbiIsIl9saW5rIiwiX2xpa2VzIiwibGlrZXMiLCJfb3duZXJJZCIsIm93bmVyIiwiX2lkIiwiX3VzZXJJZCIsInVwZGF0ZUxpa2VzIiwiX3JlbmRlckxpa2VzIiwibGlrZSIsIl9saWtlc1RvdGFsIiwibGVuZ3RoIiwiX2NhcmRFbGVtZW50IiwiZ2V0Q2FyZElkIiwiX3RyYXNoQnV0dG9uIiwicmVtb3ZlQ2FyZCIsIl9nZXRUZW1wbGF0ZSIsImNvbnRlbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsImNsb25lTm9kZSIsImdldFZpZXciLCJpdGVtIiwiaGFuZGxlRGVsZXRlQ29uZmlybWF0aW9uIiwiY2FyZFBsYWNlaG9sZGVyIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiYWNjb3VudERhdGEiLCJmaW5hbGx5IiwiY2FyZERhdGFQbGFjZWhvbGRlciIsImFjY291bnRJbWFnZVVybCIsInVzZXIiLCJjYXJkc0RhdGEiXSwic291cmNlUm9vdCI6IiJ9