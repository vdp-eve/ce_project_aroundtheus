!function(){"use strict";var e={d:function(t,n){for(var s in n)e.o(n,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:n[s]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{F3:function(){return u},oy:function(){return h},Z6:function(){return l},gB:function(){return m},Jb:function(){return a},wP:function(){return i},iy:function(){return c},LC:function(){return f},yq:function(){return d},Y9:function(){return _},fk:function(){return p},P0:function(){return v},aQ:function(){return S},E3:function(){return g}});const n=new class{constructor(e){let{baseUrl:t,headers:n}=e;this._baseUrl=t,this._headers=n}_handleResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}initialize(){return Promise.all([this.getUser(),this.getInitialCards()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>this._handleResponse(e)))}getUser(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then((e=>this._handleResponse(e)))}setUserInfo(e){let{name:t,about:n}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:n})}).then((e=>this._handleResponse(e)))}addCard(e){let{name:t,link:n}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:n})}).then((e=>this._handleResponse(e)))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>this._handleResponse(e)))}toggleLike(e,t){return fetch(`${this._baseUrl}/cards/likes/${e}`,{method:t?"DELETE":"PUT",headers:this._headers}).then((e=>this._handleResponse(e)))}updateaccountPic(e){let{avatar:t}=e;return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then((e=>this._handleResponse(e)))}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"099989f7-9742-46ef-99f8-aa8e6872a6c3","Content-Type":"application/json"}});class s{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this),this._closePopupOnRemoteClick=this._closePopupOnRemoteClick.bind(this)}open(){this._popup.classList.add("popup_open"),this._popup.addEventListener("mousedown",this._closePopupOnRemoteClick),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_open"),document.removeEventListener("keydown",this._handleEscClose),this._popup.removeEventListener("mousedown",this._closePopupOnRemoteClick)}_closePopupOnRemoteClick(e){e.target.classList.contains("popup__overlay")&&this.close()}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popup.querySelector(".popup__close-btn").addEventListener("click",(()=>this.close()))}}class r extends s{constructor(e,t,n){let{handleFormSubmit:s}=t,{loadingButtonText:r="Saving..."}=n;super(e),this._form=this._popup.querySelector(".popup__form"),this._handleFormSubmit=s,this._inputList=this._form.querySelectorAll(".popup__form-input"),this._saveButton=this._form.querySelector(".popup__button"),this._saveButtonText=this._saveButton.textContent,this._loadingButtonText=r}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}_getInputValues(){return this._objData={},this._inputList.forEach((e=>{this._objData[e.name]=e.value})),this._objData}setInputValues(e){this._objInput={},thisrenderSaving._inputList.forEach((t=>{this._objInput[t.name]=e[t.value]}))}close(){super.close(),this._form.reset()}open(){super.open()}renderSaving(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._loadingButtonText;this._saveButton.textContent=e?t:this._saveButtonText}}var o=class{constructor(e,t){this._form=t,this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._saveButtonSelector=e.saveButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._inputList=[...this._form.querySelectorAll(this._inputSelector)],this._buttonElement=this._form.querySelector(this._saveButtonSelector)}_showInputError(e,t){const n=this._form.querySelector(`.${e.id}-error`);e.classList.add(this._inputErrorClass),n.textContent=t,n.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`.${e.id}-error`);e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_setEventListeners(){this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}enableValidation(){this._form.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}};const i=document.querySelector(".account__edit-button"),a=(document.querySelector(".account__name"),document.querySelector(".account__description"),"#add__place"),c="#account__edit",u=".account__name",l=".account__description",_=document.querySelector(".popup__account-name"),d=document.querySelector(".popup__account-description"),h=".account__image",p=document.querySelector(".popup__edit-form"),m=document.querySelector(".account__add-button"),v=(document.querySelector(".popup__place-name"),document.querySelector(".js-input-type-place-url"),document.querySelector(".popup__place-form")),S=(document.querySelector(".account__image-edit-btn"),document.querySelector(".popup__edit-account-pic-form")),f=document.querySelector(".cards__list"),g={formSelector:".popup__form",inputSelector:".popup__form-input",saveButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input-type-error",errorClass:"popup__error_visible"};let E;const b=new class extends s{constructor(e,t){let{loadingButtonText:n="Saving..."}=t;super(e),this._form=this._popup.querySelector(".popup__form"),this._saveButton=this._form.querySelector(".popup__button"),this._saveButtonText=this._saveButton.textContent,this._loadingButtonText=n}open(e){this._handleSubmit=e,super.open()}close(){super.close()}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit()}))}renderSaving(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._loadingButtonText;this._saveButton.textContent=e?t:this._saveButtonText}}("#delete-popup",{loadingButtonText:"Deleting..."});b.setEventListeners();const y=e=>{const t=P(e);L.addItem(t)},L=new class{constructor(e,t){let{items:n,renderer:s}=e;this._renderedItems=n,this._renderer=s,this._container=t}addItem(e){this._container.prepend(e)}renderItems(e){e.forEach(this._renderer)}}({renderer:y},f),C=new class extends s{constructor(e){super(e),this._cardImage=document.querySelector(".popup__image-preview")}open(e,t){const n=this._cardImage;n.src=t,n.alt=e,document.querySelector(".popup__preview-name").textContent=e,super.open()}}("#view__image"),k=new r(a,{handleFormSubmit:e=>{j(e)}},{loadingButtonText:"Saving..."});m.addEventListener("click",(()=>{k.open(),w.resetValidation()}));const B=new class{constructor(e){let{nameSelector:t,jobSelector:n,accountPicSelector:s}=e;this._name=document.querySelector(t),this._about=document.querySelector(n),this._accountPic=document.querySelector(s)}getUserInfo(){return{name:this._name.textContent,about:this._about.textContent}}setUserInfo(e){let{name:t,about:n}=e;this._name.textContent=t,this._about.textContent=n}setUserAvatar(e){let{avatar:t}=e;this._accountPic.src=t}}({nameSelector:u,jobSelector:l,accountPicSelector:h}),q=new r(c,{handleFormSubmit:e=>{editaccount(e)}},{loadingButtonText:"Saving..."});i.addEventListener("click",(()=>{const{name:e,about:t}=B.getUserInfo();_.value=e,d.value=t,q.open(),x.resetValidation()}));const I=new r("#edit-account-pic-popup",{handleFormSubmit:e=>{changeaccountImage(e)}},{loadingButtonText:"Updating image..."});I.setEventListeners(),t.editaccountPicButton.addEventListener("click",(()=>{I.open(),T.resetValidation()}));const x=new o(g,p),w=new o(g,v),T=new o(g,S);q.setEventListeners(),k.setEventListeners(),C.setEventListeners();const P=e=>{const t=new class{constructor(e,t,n,s,r,o){this.handleCardClick=n,this._handleDeleteButton=s,this._cardSelector=t,this._handleLikeButton=r,this._name=e.name,this._link=e.link,this._likes=e.likes,this._ownerId=e.owner._id,this._id=e._id,this._userId=o}updateLikes(e){this._likes=e,this._renderLikes()}isLiked(){return this._likes.some((e=>e._id===this._userId))}_renderLikes(){this._likesTotal.textContent=this._likes.length,this.isLiked()?this._cardElement.querySelector(".card__place-favorite").classList.add("card__place-favorite_active"):this._cardElement.querySelector(".card__place-favorite").classList.remove("card__place-favorite_active")}getCardId(){return this._id}_setEventListeners(){this._cardElement.querySelector(".card__place-favorite").addEventListener("click",this._handleLikeButton),this._trashButton.addEventListener("click",(()=>{this._handleDeleteButton(this._cardElement)})),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this.handleCardClick({link:this._link,name:this._name})}))}removeCard(){return this._cardElement.remove(),this._cardElement=null}_getTemplate(){return document.querySelector(this._cardSelector).content.firstElementChild.cloneNode(!0)}getView(){this._cardElement=this._getTemplate(),this._cardElement.querySelector(".card__place-name").textContent=this._name;const e=this._cardElement.querySelector(".card__image");return this._likesTotal=this._cardElement.querySelector(".card__place-num"),this._trashButton=this._cardElement.querySelector(".card__trash"),this._setEventListeners(),this._renderLikes(),e.src=this._link,e.alt=this._name,this._ownerId!==this._userId&&this._trashButton.remove(),this._cardElement}}(e,"#card-template",(()=>{var t;t=e,C.open(t.name,t.link)}),(()=>{b.open((()=>{V(t)}))}),(()=>{U(t)}),E);return t.getView()},U=e=>{n.toggleLike(e.getCardId(),e.isLiked()).then((t=>{e.updateLikes(t.likes)})).catch((e=>{console.log(e)}))},j=e=>{k.renderSaving(!0),n.addCard(e).then((e=>{y(e),k.close()})).catch((e=>{console.log(e)})).finally((()=>{k.renderSaving(!1)}))},V=e=>{b.renderSaving(!0),n.deleteCard(e.getCardId()).then((()=>{e.removeCard(),b.close()})).catch((e=>{console.log(e)})).finally((()=>{b.renderSaving(!1)}))};n.initialize().then((e=>{let[t,n]=e;E=t._id,L.renderItems(n),B.setUserInfo({name:t.name,about:t.about}),B.setUserAvatar({avatar:t.avatar})})).catch((e=>{console.log(e)})),w.enableValidation(),x.enableValidation(),T.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxFQUFLNEIsU0FBUyxFQUdqQnJLLEVBQWF3SyxJQUNqQnZNLEVBQUFBLFdBQ2N1TSxFQUFnQlYsWUFBYVUsRUFBZ0J0SyxXQUN4RGQsTUFBSytKLElBQ0pxQixFQUFnQmhCLFlBQVlMLEVBQU1BLE1BQU0sSUFFekNzQixPQUFNQyxJQUNMQyxRQUFRQyxJQUFJRixFQUFJLEdBQ2hCLEVBb0JBbkQsRUFBV3NELElBQ2Z2RCxFQUFnQnZFLGNBQWEsR0FDN0I5RSxFQUFBQSxRQUNXNE0sR0FDUnpMLE1BQUtYLElBQ0p5SCxFQUFXekgsR0FDWDZJLEVBQWdCcEcsT0FBTyxJQUV4QnVKLE9BQU1DLElBQ0xDLFFBQVFDLElBQUlGLEVBQUksSUFFakJJLFNBQVEsS0FDUHhELEVBQWdCdkUsY0FBYSxFQUFNLEdBQ25DLEVBbUJBd0gsRUFBMkI5QixJQUMvQjFDLEVBQWtCaEQsY0FBYSxHQUMvQjlFLEVBQUFBLFdBQ2N3SyxFQUFLcUIsYUFDaEIxSyxNQUFLLEtBQ0pxSixFQUFLdUIsYUFDTGpFLEVBQWtCN0UsT0FBTyxJQUUxQnVKLE9BQU1DLElBQ0xDLFFBQVFDLElBQUlGLEVBQUksSUFFakJJLFNBQVEsS0FDUC9FLEVBQWtCaEQsY0FBYSxFQUFNLEdBQ3JDLEVBRU45RSxFQUFBQSxhQUVHbUIsTUFBSyxJQUF1QixJQUFyQjJMLEVBQU1DLEdBQVUsRUFDdEJsRixFQUFTaUYsRUFBS3pCLElBQ2RoRCxFQUFTVSxZQUFZZ0UsR0FDckJ2RCxFQUFTcEksWUFBWSxDQUNuQkMsS0FBTXlMLEVBQUt6TCxLQUNYQyxNQUFPd0wsRUFBS3hMLFFBRWRrSSxFQUFTTyxjQUFjLENBQ3JCNUgsT0FBUTJLLEVBQUszSyxRQUNiLElBRUhxSyxPQUFNQyxJQUNMQyxRQUFRQyxJQUFJRixFQUFJLElBR3BCbEQsRUFBb0J6QyxtQkFDcEJvRCxFQUFxQnBELG1CQUNyQndELEVBQXdCeEQsa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80L3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80L3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aFZlcmlmaWNhdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIGRlZmluaXRpb24pIHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqLCBwcm9wKSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTsgfSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwiY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG4gIF9oYW5kbGVSZXNwb25zZShyZXMpIHtcbiAgICByZXR1cm4gcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICB9XG5cbiAgaW5pdGlhbGl6ZSgpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW1xuICAgICAgdGhpcy5nZXRVc2VyKCksIFxuICAgICAgdGhpcy5nZXRJbml0aWFsQ2FyZHMoKVxuICAgIF0pO1xuICAgIFxuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXMpKTtcbiAgfVxuXG4gIGdldFVzZXIoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX2hhbmRsZVJlc3BvbnNlKHJlcykpO1xuICB9XG5cbiAgc2V0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBhYm91dDogYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX2hhbmRsZVJlc3BvbnNlKHJlcykpO1xuICB9XG5cbiAgYWRkQ2FyZCh7IG5hbWUsIGxpbmsgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBsaW5rOiBsaW5rLFxuICAgICAgfSksXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXMpKTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXMpKTtcbiAgfVxuXG4gIHRvZ2dsZUxpa2UoaWQsIGlzTGlrZWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtpZH1gLCB7XG4gICAgICBtZXRob2Q6IGlzTGlrZWQgPyBcIkRFTEVURVwiIDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXMpKTtcbiAgfVxuICB1cGRhdGVhY2NvdW50UGljKHsgYXZhdGFyIH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXIsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX2hhbmRsZVJlc3BvbnNlKHJlcykpO1xuICB9XG5cbiBcbn1cblxuZXhwb3J0IGNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTJcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiMDk5OTg5ZjctOTc0Mi00NmVmLTk5ZjgtYWE4ZTY4NzJhNmMzXCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fY2xvc2VQb3B1cE9uUmVtb3RlQ2xpY2sgPSB0aGlzLl9jbG9zZVBvcHVwT25SZW1vdGVDbGljay5iaW5kKHRoaXMpO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlblwiKTtcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2Nsb3NlUG9wdXBPblJlbW90ZUNsaWNrKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlblwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgdGhpcy5fcG9wdXAucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9jbG9zZVBvcHVwT25SZW1vdGVDbGljayk7XG4gIH1cblxuICBfY2xvc2VQb3B1cE9uUmVtb3RlQ2xpY2soZXZ0KSB7XG4gICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfX292ZXJsYXlcIikpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXBcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jbG9zZS1idG5cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5jbG9zZSgpKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHBvcHVwU2VsZWN0b3IsXG4gICAgeyBoYW5kbGVGb3JtU3VibWl0IH0sXG4gICAgeyBsb2FkaW5nQnV0dG9uVGV4dCA9IFwiU2F2aW5nLi4uXCIgfVxuICApIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBfX2Zvcm0taW5wdXRcIik7XG4gICAgdGhpcy5fc2F2ZUJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fYnV0dG9uXCIpO1xuICAgIHRoaXMuX3NhdmVCdXR0b25UZXh0ID0gdGhpcy5fc2F2ZUJ1dHRvbi50ZXh0Q29udGVudDtcbiAgICB0aGlzLl9sb2FkaW5nQnV0dG9uVGV4dCA9IGxvYWRpbmdCdXR0b25UZXh0O1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgZXZ0ID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICB9KTtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICB0aGlzLl9vYmpEYXRhID0ge307XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goaW5wdXQgPT4ge1xuICAgICAgdGhpcy5fb2JqRGF0YVtpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLl9vYmpEYXRhO1xuICB9XG5cbiAgc2V0SW5wdXRWYWx1ZXMoZGF0YSkge1xuICAgIHRoaXMuX29iaklucHV0ID0ge307XG4gICAgdGhpc3JlbmRlclNhdmluZy5faW5wdXRMaXN0LmZvckVhY2goaW5wdXQgPT4ge1xuICAgICAgdGhpcy5fb2JqSW5wdXRbaW5wdXQubmFtZV0gPSBkYXRhW2lucHV0LnZhbHVlXTtcbiAgICB9KTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cblxuICByZW5kZXJTYXZpbmcoaXNTYXZpbmcsIGxvYWRpbmdUZXh0ID0gdGhpcy5fbG9hZGluZ0J1dHRvblRleHQpIHtcbiAgICBpZiAoaXNTYXZpbmcpIHtcbiAgICAgIHRoaXMuX3NhdmVCdXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3NhdmVCdXR0b25UZXh0O1xuICAgIH1cbiAgfVxuXG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcblxuY2xhc3MgcG9wdXBXaXRoVmVyaWZpY2F0aW9uIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCB7IGxvYWRpbmdCdXR0b25UZXh0ID0gXCJTYXZpbmcuLi5cIiB9KSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XG4gICAgdGhpcy5fc2F2ZUJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fYnV0dG9uXCIpO1xuICAgIHRoaXMuX3NhdmVCdXR0b25UZXh0ID0gdGhpcy5fc2F2ZUJ1dHRvbi50ZXh0Q29udGVudDtcbiAgICB0aGlzLl9sb2FkaW5nQnV0dG9uVGV4dCA9IGxvYWRpbmdCdXR0b25UZXh0O1xuICB9XG5cbiAgb3BlbihhY3Rpb24pIHtcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBhY3Rpb247XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG4gIGNsb3NlKCkge1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBldnQgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVTdWJtaXQoKTtcbiAgICB9KTtcbiAgfVxuXG4gIHJlbmRlclNhdmluZyhpc1NhdmluZywgbG9hZGluZ1RleHQgPSB0aGlzLl9sb2FkaW5nQnV0dG9uVGV4dCkge1xuICAgIGlmIChpc1NhdmluZykge1xuICAgICAgdGhpcy5fc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zYXZlQnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fc2F2ZUJ1dHRvblRleHQ7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IHBvcHVwV2l0aFZlcmlmaWNhdGlvbjtcbiIsImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3Rvcih2YWxpZGF0aW9uU2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5fZm9ybSA9IGZvcm1FbGVtZW50O1xuXG4gICAgdGhpcy5fZm9ybVNlbGVjdG9yID0gdmFsaWRhdGlvblNldHRpbmdzLmZvcm1TZWxlY3RvcjtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gdmFsaWRhdGlvblNldHRpbmdzLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc2F2ZUJ1dHRvblNlbGVjdG9yID0gdmFsaWRhdGlvblNldHRpbmdzLnNhdmVCdXR0b25TZWxlY3RvcjtcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gdmFsaWRhdGlvblNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gdmFsaWRhdGlvblNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gdmFsaWRhdGlvblNldHRpbmdzLmVycm9yQ2xhc3M7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gWy4uLnRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKV07XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zYXZlQnV0dG9uU2VsZWN0b3IpO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKGlucHV0RWxlbWVudCA9PiB7XG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcbiAgICB9KTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKGlucHV0RWxlbWVudCA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgZnVuY3Rpb24oZXZ0KSB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goaW5wdXRFbGVtZW50ID0+IHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfSk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcbiIsImV4cG9ydCBjb25zdCBlZGl0QWNjb3VudE9wZW5CdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFjY291bnRfX2VkaXQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IGFjY291bnROYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFjY291bnRfX25hbWVcIik7XG5leHBvcnQgY29uc3QgYWNjb3VudFRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFjY291bnRfX2Rlc2NyaXB0aW9uXCIpO1xuZXhwb3J0IGNvbnN0IGFkZFBvcHVwU2VsZWN0b3IgPSBcIiNhZGRfX3BsYWNlXCI7XG5leHBvcnQgY29uc3QgZWRpdFBvcHVwU2VsZWN0b3IgPSBcIiNhY2NvdW50X19lZGl0XCI7XG5leHBvcnQgY29uc3QgYWNjb3VudE5hbWUgPSBcIi5hY2NvdW50X19uYW1lXCI7XG5leHBvcnQgY29uc3QgYWNjb3VudFRpdGxlID0gXCIuYWNjb3VudF9fZGVzY3JpcHRpb25cIjtcblxuZXhwb3J0IGNvbnN0IHBvcHVwQWNjb3VudE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19hY2NvdW50LW5hbWVcIik7XG5leHBvcnQgY29uc3QgcG9wdXBBY2NvdW50SWNvbnNUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2FjY291bnQtZGVzY3JpcHRpb25cIik7XG5leHBvcnQgY29uc3QgYWNjb3VudFBpY1NlbGVjdG9yID0gXCIuYWNjb3VudF9faW1hZ2VcIjtcbmV4cG9ydCBjb25zdCBzdWJtaXRBY2NvdW50RWRpdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2VkaXQtZm9ybVwiKTtcbmV4cG9ydCBjb25zdCBhZGRQbGFjZXNPcGVuQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hY2NvdW50X19hZGQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IHBvcHVwUGxhY2VOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fcGxhY2UtbmFtZVwiKTtcbmV4cG9ydCBjb25zdCBwb3B1cFBsYWNlVXJsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5qcy1pbnB1dC10eXBlLXBsYWNlLXVybFwiKTtcbmV4cG9ydCBjb25zdCBzdWJtaXROZXdQbGFjZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX3BsYWNlLWZvcm1cIik7XG5leHBvcnQgY29uc3QgZWRpdEFjY291bnRQaWNCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFjY291bnRfX2ltYWdlLWVkaXQtYnRuXCIpO1xuZXhwb3J0IGNvbnN0IHN1Ym1pdE5ld2FjY291bnRQaWMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19lZGl0LWFjY291bnQtcGljLWZvcm1cIik7XG5cbi8vIENhcmRzIExpc3QgXG5leHBvcnQgY29uc3QgcGxhY2VMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcblxuXG4vLyBQbGFjZSBDYXJkc1xuZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiUmVhY2hpbmcgZm9yIHRoZSBNb29uXCIsXG4gICAgbGluazogXCJodHRwczovL2kucGluaW1nLmNvbS81NjR4Lzg4LzliLzM2Lzg4OWIzNjA3YjJiOTM0MzBiNDBkN2YwM2FlOTE4ZThkLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJQb3J0cmFpdCBvZiBCYXJiYXJhIG9mIFBvcnR1Z2FsXCIsXG4gICAgbGluazogXCJodHRwczovL2kucGluaW1nLmNvbS81NjR4LzhhL2EwLzcwLzhhYTA3MDUzMTc4Y2IxYmJiNGEzZjkzMzc5ZDc1MGQyLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJTaW1lcmVueWFcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaS5waW5pbWcuY29tLzU2NHgvNDYvNjYvMzAvNDY2NjMwNTBlMzg4NTUwYmYyNGI4MDg2MTc5NjI3MWUuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkN1cGlkIGFuZCBQc3ljaGVcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaS5waW5pbWcuY29tLzU2NHgvMTYvZTIvOGIvMTZlMjhiYmI0ODgwODVjZjVkZjY5ZjYyYzA3NzkxY2IuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlN0cmVldCBpbiB0aGUgRXZlbmluZywgUHJhZ3VlXCIsXG4gICAgbGluazogXCJodHRwczovL2kucGluaW1nLmNvbS81NjR4L2ZlLzg1LzNiL2ZlODUzYjEyZWU1MjkwYTRiMDk2N2VjNmUyMGRlNzgyLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJHaXJsIGF0IHRoZSBQaWFub1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9pLnBpbmltZy5jb20vNTY0eC9kNy8wYi81My9kNzBiNTM0NzkxZjUwZjYyZTc0MTY2OWFlY2Q3YTQ3OS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiR29pbmcgSG9tZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9pLnBpbmltZy5jb20vNTY0eC9hZC81My8yYi9hZDUzMmIzMWJiZmNkMDA2YzZiOGYzM2E5YjRjZWJmMy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiUmFpbnkgTmlnaHRcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaS5waW5pbWcuY29tLzU2NHgvMWEvNTAvMzIvMWE1MDMyMWI5MDViNWRkZDYwYjI4MDJjMWI1MGFkNGIuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlRoZSBTcHJlYWRpbmcgVHJlZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9pLnBpbmltZy5jb20vNTY0eC9kNi9iMi9mOS9kNmIyZjk0NjU3OTdjNGFkZWM1ZmNhNjQxYTFkZDJkOC5qcGdcIixcbiAgfSxcbl07XG5cbi8vIFZhbGlkYXRvcnMgXG5cbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uU2V0dGluZ3MgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIucG9wdXBfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2Zvcm0taW5wdXRcIixcbiAgc2F2ZUJ1dHRvblNlbGVjdG9yOiBcIi5wb3B1cF9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwicG9wdXBfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0LXR5cGUtZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJwb3B1cF9fZXJyb3JfdmlzaWJsZVwiXG59O1xuXG5cbiIsIi8vIEluZGV4IENTUyBJbXBvcnRcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5cbi8vIEpTIEltcG9ydHNcbmltcG9ydCB7IGFwaSB9IGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBwb3B1cFdpdGhWZXJpZmljYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoVmVyaWZpY2F0aW9uLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQge1xuICBlZGl0QWNjb3VudE9wZW5CdG4sXG4gIGFjY291bnROYW1lLFxuICBhY2NvdW50VGl0bGUsXG4gIHN1Ym1pdEFjY291bnRFZGl0LFxuICBhZGRQbGFjZXNPcGVuQnRuLFxuICBlZGl0YWNjb3VudFBpY0J1dHRvbixcbiAgYWNjb3VudFBpY1NlbGVjdG9yLFxuICBwb3B1cFBsYWNlTmFtZSxcbiAgcG9wdXBQbGFjZVVybCxcbiAgcG9wdXBBY2NvdW50TmFtZSxcbiAgc3VibWl0TmV3YWNjb3VudFBpYyxcbiAgYWNjb3VudE5hbWVJbnB1dCxcbiAgcG9wdXBBY2NvdW50SWNvbnNUaXRsZSxcbiAgYWNjb3VudFRpdGxlSW5wdXQsXG4gIHN1Ym1pdE5ld1BsYWNlLFxuICBlZGl0UG9wdXBTZWxlY3RvcixcbiAgcGxhY2VMaXN0LFxuICBhZGRQb3B1cFNlbGVjdG9yLFxuICB2YWxpZGF0aW9uU2V0dGluZ3Ncbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuXG5sZXQgdXNlcklkO1xuXG4vLyBDYXJkIEZ1bmN0aW9uc1xuY29uc3QgY29uZmlybWF0aW9uUG9wdXAgPSBuZXcgcG9wdXBXaXRoVmVyaWZpY2F0aW9uKFwiI2RlbGV0ZS1wb3B1cFwiLCB7XG4gIGxvYWRpbmdCdXR0b25UZXh0OiBcIkRlbGV0aW5nLi4uXCJcbn0pO1xuY29uZmlybWF0aW9uUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgcmVuZGVyQ2FyZCA9IGNhcmREYXRhUGxhY2VIb2xkZXIgPT4ge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoY2FyZERhdGFQbGFjZUhvbGRlcik7XG4gIGNhcmRMaXN0LmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xufTtcblxuY29uc3QgY2FyZExpc3QgPSBuZXcgU2VjdGlvbihcbiAge1xuICAgIHJlbmRlcmVyOiByZW5kZXJDYXJkXG4gIH0sXG4gIHBsYWNlTGlzdFxuKTtcblxuXG5jb25zdCBwcmV2aWV3SW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiN2aWV3X19pbWFnZVwiKTtcbmNvbnN0IGhhbmRsZUNhcmRDbGljayA9IGl0ZW0gPT4ge1xuICBwcmV2aWV3SW1hZ2VQb3B1cC5vcGVuKGl0ZW0ubmFtZSwgaXRlbS5saW5rKTtcbn07XG5cbmNvbnN0IGFkZE5ld0NhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBhZGRQb3B1cFNlbGVjdG9yLFxuICB7XG4gICAgaGFuZGxlRm9ybVN1Ym1pdDogZGF0YSA9PiB7XG4gICAgICBhZGRBQ2FyZChkYXRhKTtcbiAgICB9XG4gIH0sXG4gIHtcbiAgICBsb2FkaW5nQnV0dG9uVGV4dDogXCJTYXZpbmcuLi5cIlxuICB9XG4pO1xuXG5hZGRQbGFjZXNPcGVuQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGFkZE5ld0NhcmRQb3B1cC5vcGVuKCk7XG4gIHBsYWNlc0Zvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG59KTtcblxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICBuYW1lU2VsZWN0b3I6IGFjY291bnROYW1lLFxuICBqb2JTZWxlY3RvcjogYWNjb3VudFRpdGxlLFxuICBhY2NvdW50UGljU2VsZWN0b3I6IGFjY291bnRQaWNTZWxlY3RvclxufSk7XG5cbi8vIFBvcHVwIEZ1bmN0aW9uc1xuY29uc3QgZWRpdEZvcm1Qb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBlZGl0UG9wdXBTZWxlY3RvcixcbiAge1xuICAgIGhhbmRsZUZvcm1TdWJtaXQ6IGRhdGEgPT4ge1xuICAgICAgZWRpdGFjY291bnQoZGF0YSk7XG4gICAgfVxuICB9LFxuICB7XG4gICAgbG9hZGluZ0J1dHRvblRleHQ6IFwiU2F2aW5nLi4uXCJcbiAgfVxuKTtcbmVkaXRBY2NvdW50T3BlbkJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjb25zdCB7IG5hbWUsIGFib3V0IH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICBwb3B1cEFjY291bnROYW1lLnZhbHVlID0gbmFtZTtcbiAgcG9wdXBBY2NvdW50SWNvbnNUaXRsZS52YWx1ZSA9IGFib3V0O1xuICBlZGl0Rm9ybVBvcHVwLm9wZW4oKTtcbiAgYWNjb3VudEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG59KTtcbmNvbnN0IGVkaXRQb2ZpbGVQaWNGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIFwiI2VkaXQtYWNjb3VudC1waWMtcG9wdXBcIixcbiAge1xuICAgIGhhbmRsZUZvcm1TdWJtaXQ6IGRhdGEgPT4ge1xuICAgICAgY2hhbmdlYWNjb3VudEltYWdlKGRhdGEpO1xuICAgIH1cbiAgfSxcbiAge1xuICAgIGxvYWRpbmdCdXR0b25UZXh0OiBcIlVwZGF0aW5nIGltYWdlLi4uXCJcbiAgfVxuKTtcblxuZWRpdFBvZmlsZVBpY0Zvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmVkaXRhY2NvdW50UGljQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGVkaXRQb2ZpbGVQaWNGb3JtLm9wZW4oKTtcbiAgYWNjb3VudFBpY0Zvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG59KTtcblxuY29uc3QgYWNjb3VudEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgdmFsaWRhdGlvblNldHRpbmdzLFxuICBzdWJtaXRBY2NvdW50RWRpdFxuKTtcbmNvbnN0IHBsYWNlc0Zvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uU2V0dGluZ3MsIHN1Ym1pdE5ld1BsYWNlKTtcblxuY29uc3QgYWNjb3VudFBpY0Zvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgdmFsaWRhdGlvblNldHRpbmdzLFxuICBzdWJtaXROZXdhY2NvdW50UGljXG4pO1xuXG5lZGl0Rm9ybVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5hZGROZXdDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxucHJldmlld0ltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgY3JlYXRlQ2FyZCA9IGNhcmREYXRhUGxhY2VIb2xkZXIgPT4ge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXG4gICAgY2FyZERhdGFQbGFjZUhvbGRlcixcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsXG4gICAgKCkgPT4ge1xuICAgICAgaGFuZGxlQ2FyZENsaWNrKGNhcmREYXRhUGxhY2VIb2xkZXIpO1xuICAgIH0sXG4gICAgKCkgPT4ge1xuICAgICAgY29uZmlybWF0aW9uUG9wdXAub3BlbigoKSA9PiB7XG4gICAgICAgIGhhbmRsZURlbGV0ZUNvbmZpcm1hdGlvbihjYXJkKTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgKCkgPT4ge1xuICAgICAgdG9nZ2xlTGlrZShjYXJkKTtcbiAgICB9LFxuICAgIHVzZXJJZFxuICApO1xuICByZXR1cm4gY2FyZC5nZXRWaWV3KCk7XG59O1xuXG5jb25zdCB0b2dnbGVMaWtlID0gY2FyZFBsYWNlaG9sZGVyID0+IHtcbiAgYXBpXG4gICAgLnRvZ2dsZUxpa2UoY2FyZFBsYWNlaG9sZGVyLmdldENhcmRJZCgpLCBjYXJkUGxhY2Vob2xkZXIuaXNMaWtlZCgpKVxuICAgIC50aGVuKGxpa2VzID0+IHtcbiAgICAgIGNhcmRQbGFjZWhvbGRlci51cGRhdGVMaWtlcyhsaWtlcy5saWtlcyk7XG4gICAgfSlcbiAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgfSk7XG59O1xuY29uc3QgZWRpdEFjY291bnQgPSBhY2NvdW50RGF0YSA9PiB7XG4gIGVkaXRGb3JtUG9wdXAucmVuZGVyU2F2aW5nKHRydWUpO1xuICBhcGlcbiAgICAuc2V0VXNlckluZm8oYWNjb3VudERhdGEpXG4gICAgLnRoZW4oYWNjb3VudERhdGEgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgICAgICBuYW1lOiBhY2NvdW50RGF0YS5uYW1lLFxuICAgICAgICBhYm91dDogYWNjb3VudERhdGEuYWJvdXRcbiAgICAgIH0pO1xuICAgICAgZWRpdEZvcm1Qb3B1cC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgZWRpdEZvcm1Qb3B1cC5yZW5kZXJTYXZpbmcoZmFsc2UpO1xuICAgIH0pO1xufTtcbmNvbnN0IGFkZEFDYXJkID0gY2FyZERhdGFQbGFjZWhvbGRlciA9PiB7XG4gIGFkZE5ld0NhcmRQb3B1cC5yZW5kZXJTYXZpbmcodHJ1ZSk7XG4gIGFwaVxuICAgIC5hZGRDYXJkKGNhcmREYXRhUGxhY2Vob2xkZXIpXG4gICAgLnRoZW4ocmVzID0+IHtcbiAgICAgIHJlbmRlckNhcmQocmVzKTtcbiAgICAgIGFkZE5ld0NhcmRQb3B1cC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgYWRkTmV3Q2FyZFBvcHVwLnJlbmRlclNhdmluZyhmYWxzZSk7XG4gICAgfSk7XG59O1xuY29uc3QgY2hhbmdlQWNjb3VudEltYWdlID0gYWNjb3VudEltYWdlVXJsID0+IHtcbiAgZWRpdFBvZmlsZVBpY0Zvcm0ucmVuZGVyU2F2aW5nKHRydWUpO1xuICBhcGlcbiAgICAudXBkYXRlYWNjb3VudFBpYyhhY2NvdW50SW1hZ2VVcmwpXG4gICAgLnRoZW4oYWNjb3VudEltYWdlVXJsID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIoe1xuICAgICAgICBhdmF0YXI6IGFjY291bnRJbWFnZVVybC5hdmF0YXJcbiAgICAgIH0pO1xuICAgICAgZWRpdFBvZmlsZVBpY0Zvcm0uY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaChlcnIgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGVkaXRQb2ZpbGVQaWNGb3JtLnJlbmRlclNhdmluZyhmYWxzZSk7XG4gICAgfSk7XG59O1xuY29uc3QgaGFuZGxlRGVsZXRlQ29uZmlybWF0aW9uID0gY2FyZCA9PiB7XG4gIGNvbmZpcm1hdGlvblBvcHVwLnJlbmRlclNhdmluZyh0cnVlKTtcbiAgYXBpXG4gICAgLmRlbGV0ZUNhcmQoY2FyZC5nZXRDYXJkSWQoKSlcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICBjYXJkLnJlbW92ZUNhcmQoKTtcbiAgICAgIGNvbmZpcm1hdGlvblBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBjb25maXJtYXRpb25Qb3B1cC5yZW5kZXJTYXZpbmcoZmFsc2UpO1xuICAgIH0pO1xufTtcbmFwaVxuICAuaW5pdGlhbGl6ZSgpXG4gIC50aGVuKChbdXNlciwgY2FyZHNEYXRhXSkgPT4ge1xuICAgIHVzZXJJZCA9IHVzZXIuX2lkO1xuICAgIGNhcmRMaXN0LnJlbmRlckl0ZW1zKGNhcmRzRGF0YSk7XG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgICAgbmFtZTogdXNlci5uYW1lLFxuICAgICAgYWJvdXQ6IHVzZXIuYWJvdXRcbiAgICB9KTtcbiAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKHtcbiAgICAgIGF2YXRhcjogdXNlci5hdmF0YXJcbiAgICB9KTtcbiAgfSlcbiAgLmNhdGNoKGVyciA9PiB7XG4gICAgY29uc29sZS5sb2coZXJyKTtcbiAgfSk7XG5cbnBsYWNlc0Zvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuYWNjb3VudEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuYWNjb3VudFBpY0Zvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpOyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXIpIHtcbiAgICB0aGlzLl9yZW5kZXJlZEl0ZW1zID0gaXRlbXM7IFxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gY29udGFpbmVyO1xuICB9XG5cbiAgYWRkSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XG4gIH1cblxuICByZW5kZXJJdGVtcyhpdGVtcykge1xuICAgIGl0ZW1zLmZvckVhY2godGhpcy5fcmVuZGVyZXIpO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZS1wcmV2aWV3XCIpO1xuICB9XG4gIG9wZW4obmFtZSwgbGluaykge1xuICAgIGNvbnN0IGltYWdlRWxlbWVudCA9IHRoaXMuX2NhcmRJbWFnZTtcbiAgICBpbWFnZUVsZW1lbnQuc3JjID0gbGluaztcbiAgICBpbWFnZUVsZW1lbnQuYWx0ID0gbmFtZTtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIucG9wdXBfX3ByZXZpZXctbmFtZVwiXG4gICAgKS50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEltYWdlO1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IsYWNjb3VudFBpY1NlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9uYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX2Fib3V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XG4gICAgdGhpcy5fYWNjb3VudFBpYyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYWNjb3VudFBpY1NlbGVjdG9yKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7IFxuICAgICAgbmFtZTogdGhpcy5fbmFtZS50ZXh0Q29udGVudCwgXG4gICAgICBhYm91dDogdGhpcy5fYWJvdXQudGV4dENvbnRlbnQgXG4gICAgfVxuICB9XG5cbiAgc2V0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XG4gICAgdGhpcy5fbmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgdGhpcy5fYWJvdXQudGV4dENvbnRlbnQgPSBhYm91dDtcbiAgfVxuXG4gIHNldFVzZXJBdmF0YXIoe2F2YXRhcn0pe1xuICAgIHRoaXMuX2FjY291bnRQaWMuc3JjID0gYXZhdGFyO1xuICB9XG59XG4iLCJjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoXG4gICAgZGF0YSxcbiAgICBjYXJkU2VsZWN0b3IsXG4gICAgaGFuZGxlQ2FyZENsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUJ1dHRvbixcbiAgICBoYW5kbGVMaWtlQnV0dG9uLFxuICAgIHVzZXJJZFxuICApIHtcbiAgICB0aGlzLmhhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVCdXR0b24gPSBoYW5kbGVEZWxldGVCdXR0b247XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VCdXR0b24gPSBoYW5kbGVMaWtlQnV0dG9uO1xuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XG4gICAgdGhpcy5fb3duZXJJZCA9IGRhdGEub3duZXIuX2lkO1xuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xuICB9XG5cbiAgdXBkYXRlTGlrZXMobGlrZXMpIHtcbiAgICB0aGlzLl9saWtlcyA9IGxpa2VzO1xuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XG4gIH1cblxuICBpc0xpa2VkKCkge1xuICAgIHJldHVybiB0aGlzLl9saWtlcy5zb21lKGxpa2UgPT4gbGlrZS5faWQgPT09IHRoaXMuX3VzZXJJZCk7XG4gIH1cblxuICBfcmVuZGVyTGlrZXMoKSB7XG4gICAgdGhpcy5fbGlrZXNUb3RhbC50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcbiAgICBpZiAodGhpcy5pc0xpa2VkKCkpIHtcbiAgICAgIHRoaXMuX2NhcmRFbGVtZW50XG4gICAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3BsYWNlLWZhdm9yaXRlXCIpXG4gICAgICAgIC5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fcGxhY2UtZmF2b3JpdGVfYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19wbGFjZS1mYXZvcml0ZVwiKVxuICAgICAgICAuY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX3BsYWNlLWZhdm9yaXRlX2FjdGl2ZVwiKTtcbiAgICB9XG4gIH1cblxuICBnZXRDYXJkSWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lkO1xuICB9XG4gIC8vcnVucyAzcmRcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19wbGFjZS1mYXZvcml0ZVwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKTtcblxuICAgIHRoaXMuX3RyYXNoQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVCdXR0b24odGhpcy5fY2FyZEVsZW1lbnQpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5oYW5kbGVDYXJkQ2xpY2soeyBsaW5rOiB0aGlzLl9saW5rLCBuYW1lOiB0aGlzLl9uYW1lIH0pO1xuICAgICAgfSk7XG4gIH1cblxuICByZW1vdmVDYXJkKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xuICAgIHJldHVybiAodGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsKTtcbiAgfVxuXG4gIC8vcnVucyAybmRcbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIHJldHVybiBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQuY2xvbmVOb2RlKHRydWUpOyAvLy9fZ2V0VGVtcGxhdGVcbiAgfVxuICAvL3J1bnMgMXN0XG4gIGdldFZpZXcoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5jYXJkX19wbGFjZS1uYW1lXCJcbiAgICApLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICBjb25zdCBpbWFnZUVsZW1lbnQgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2xpa2VzVG90YWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3BsYWNlLW51bVwiKTtcbiAgICB0aGlzLl90cmFzaEJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdHJhc2hcIik7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xuICAgIGltYWdlRWxlbWVudC5zcmMgPSB0aGlzLl9saW5rO1xuICAgIGltYWdlRWxlbWVudC5hbHQgPSB0aGlzLl9uYW1lO1xuICAgIGlmICh0aGlzLl9vd25lcklkICE9PSB0aGlzLl91c2VySWQpIHtcbiAgICAgIHRoaXMuX3RyYXNoQnV0dG9uLnJlbW92ZSgpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQ2FyZDtcbiJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiZXhwb3J0cyIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJhcGkiLCJjb25zdHJ1Y3RvciIsImJhc2VVcmwiLCJoZWFkZXJzIiwidGhpcyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfaGFuZGxlUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiaW5pdGlhbGl6ZSIsImFsbCIsImdldFVzZXIiLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsInRoZW4iLCJzZXRVc2VySW5mbyIsIm5hbWUiLCJhYm91dCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWRkQ2FyZCIsImxpbmsiLCJkZWxldGVDYXJkIiwiY2FyZElkIiwidG9nZ2xlTGlrZSIsImlkIiwiaXNMaWtlZCIsInVwZGF0ZWFjY291bnRQaWMiLCJhdmF0YXIiLCJhdXRob3JpemF0aW9uIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIl9jbG9zZVBvcHVwT25SZW1vdGVDbGljayIsIm9wZW4iLCJjbGFzc0xpc3QiLCJhZGQiLCJhZGRFdmVudExpc3RlbmVyIiwiY2xvc2UiLCJyZW1vdmUiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0IiwidGFyZ2V0IiwiY29udGFpbnMiLCJzZXRFdmVudExpc3RlbmVycyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0IiwibG9hZGluZ0J1dHRvblRleHQiLCJzdXBlciIsIl9mb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfaW5wdXRMaXN0IiwicXVlcnlTZWxlY3RvckFsbCIsIl9zYXZlQnV0dG9uIiwiX3NhdmVCdXR0b25UZXh0IiwidGV4dENvbnRlbnQiLCJfbG9hZGluZ0J1dHRvblRleHQiLCJwcmV2ZW50RGVmYXVsdCIsIl9nZXRJbnB1dFZhbHVlcyIsIl9vYmpEYXRhIiwiZm9yRWFjaCIsImlucHV0Iiwic2V0SW5wdXRWYWx1ZXMiLCJkYXRhIiwiX29iaklucHV0IiwidGhpc3JlbmRlclNhdmluZyIsInJlc2V0IiwicmVuZGVyU2F2aW5nIiwiaXNTYXZpbmciLCJsb2FkaW5nVGV4dCIsInZhbGlkYXRpb25TZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX2Zvcm1TZWxlY3RvciIsImZvcm1TZWxlY3RvciIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zYXZlQnV0dG9uU2VsZWN0b3IiLCJzYXZlQnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2J1dHRvbkVsZW1lbnQiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hhc0ludmFsaWRJbnB1dCIsInNvbWUiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJkaXNhYmxlZCIsImVuYWJsZVZhbGlkYXRpb24iLCJyZXNldFZhbGlkYXRpb24iLCJlZGl0QWNjb3VudE9wZW5CdG4iLCJhZGRQb3B1cFNlbGVjdG9yIiwiZWRpdFBvcHVwU2VsZWN0b3IiLCJhY2NvdW50TmFtZSIsImFjY291bnRUaXRsZSIsInBvcHVwQWNjb3VudE5hbWUiLCJwb3B1cEFjY291bnRJY29uc1RpdGxlIiwiYWNjb3VudFBpY1NlbGVjdG9yIiwic3VibWl0QWNjb3VudEVkaXQiLCJhZGRQbGFjZXNPcGVuQnRuIiwic3VibWl0TmV3UGxhY2UiLCJzdWJtaXROZXdhY2NvdW50UGljIiwicGxhY2VMaXN0IiwidXNlcklkIiwiY29uZmlybWF0aW9uUG9wdXAiLCJhY3Rpb24iLCJfaGFuZGxlU3VibWl0IiwicmVuZGVyQ2FyZCIsImNhcmREYXRhUGxhY2VIb2xkZXIiLCJjYXJkRWxlbWVudCIsImNyZWF0ZUNhcmQiLCJjYXJkTGlzdCIsImFkZEl0ZW0iLCJjb250YWluZXIiLCJpdGVtcyIsInJlbmRlcmVyIiwiX3JlbmRlcmVkSXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiZWxlbWVudCIsInByZXBlbmQiLCJyZW5kZXJJdGVtcyIsInByZXZpZXdJbWFnZVBvcHVwIiwiX2NhcmRJbWFnZSIsImltYWdlRWxlbWVudCIsInNyYyIsImFsdCIsImFkZE5ld0NhcmRQb3B1cCIsImFkZEFDYXJkIiwicGxhY2VzRm9ybVZhbGlkYXRvciIsInVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJfbmFtZSIsIl9hYm91dCIsIl9hY2NvdW50UGljIiwiZ2V0VXNlckluZm8iLCJzZXRVc2VyQXZhdGFyIiwiZWRpdEZvcm1Qb3B1cCIsImVkaXRhY2NvdW50IiwiYWNjb3VudEZvcm1WYWxpZGF0b3IiLCJlZGl0UG9maWxlUGljRm9ybSIsImNoYW5nZWFjY291bnRJbWFnZSIsImVkaXRhY2NvdW50UGljQnV0dG9uIiwiYWNjb3VudFBpY0Zvcm1WYWxpZGF0b3IiLCJGb3JtVmFsaWRhdG9yIiwiY2FyZCIsImNhcmRTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZURlbGV0ZUJ1dHRvbiIsImhhbmRsZUxpa2VCdXR0b24iLCJfaGFuZGxlRGVsZXRlQnV0dG9uIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVMaWtlQnV0dG9uIiwiX2xpbmsiLCJfbGlrZXMiLCJsaWtlcyIsIl9vd25lcklkIiwib3duZXIiLCJfaWQiLCJfdXNlcklkIiwidXBkYXRlTGlrZXMiLCJfcmVuZGVyTGlrZXMiLCJsaWtlIiwiX2xpa2VzVG90YWwiLCJsZW5ndGgiLCJfY2FyZEVsZW1lbnQiLCJnZXRDYXJkSWQiLCJfdHJhc2hCdXR0b24iLCJyZW1vdmVDYXJkIiwiX2dldFRlbXBsYXRlIiwiY29udGVudCIsImZpcnN0RWxlbWVudENoaWxkIiwiY2xvbmVOb2RlIiwiZ2V0VmlldyIsIml0ZW0iLCJoYW5kbGVEZWxldGVDb25maXJtYXRpb24iLCJjYXJkUGxhY2Vob2xkZXIiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJjYXJkRGF0YVBsYWNlaG9sZGVyIiwiZmluYWxseSIsInVzZXIiLCJjYXJkc0RhdGEiXSwic291cmNlUm9vdCI6IiJ9