!function(){"use strict";const e=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_handleResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}initialize(){return Promise.all([this.getUser(),this.getInitialCards()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>this._handleResponse(e)))}getUser(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then((e=>this._handleResponse(e)))}setUserInfo(e){let{name:t,about:s}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:s})}).then((e=>this._handleResponse(e)))}addCard(e){let{name:t,link:s}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})}).then((e=>this._handleResponse(e)))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>this._handleResponse(e)))}toggleLike(e,t){return fetch(`${this._baseUrl}/cards/likes/${e}`,{method:t?"DELETE":"PUT",headers:this._headers}).then((e=>this._handleResponse(e)))}updateAccountPic(e){let{avatar:t}=e;return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then((e=>this._handleResponse(e)))}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"099989f7-9742-46ef-99f8-aa8e6872a6c3","Content-Type":"application/json"}});class t{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this),this._closePopupOnRemoteClick=this._closePopupOnRemoteClick.bind(this)}open(){this._popup.classList.add("popup_open"),this._popup.addEventListener("mousedown",this._closePopupOnRemoteClick),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_open"),document.removeEventListener("keydown",this._handleEscClose),this._popup.removeEventListener("mousedown",this._closePopupOnRemoteClick)}_closePopupOnRemoteClick(e){e.target.classList.contains("popup__overlay")&&this.close()}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popup.querySelector(".popup__close-btn").addEventListener("click",(()=>this.close()))}}class s extends t{constructor(e,t,s){let{handleFormSubmit:n}=t,{loadingButtonText:r="Saving..."}=s;super(e),this._form=this._popup.querySelector(".popup__form"),this._handleFormSubmit=n,this._inputList=this._form.querySelectorAll(".popup__form-input"),this._saveButton=this._form.querySelector(".popup__button"),this._saveButtonText=this._saveButton.textContent,this._loadingButtonText=r}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setInputValues(e){this._objInput={},this._inputList.forEach((t=>{this._objInput[t.name]=e[t.value]}))}close(){super.close(),this._form.reset()}open(){super.open()}renderSaving(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._loadingButtonText;this._saveButton.textContent=e?t:this._saveButtonText}}var n=class{constructor(e,t){this._form=t,this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._saveButtonSelector=e.saveButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._inputList=[...this._form.querySelectorAll(this._inputSelector)],this._buttonElement=this._form.querySelector(this._saveButtonSelector)}_showInputError(e,t){const s=this._form.querySelector(`.${e.id}-error`);e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`.${e.id}-error`);e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_setEventListeners(){this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.removeAttribute("disabled"))}enableValidation(){this._form.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}};const r=document.querySelector(".account__edit-button"),o=(document.querySelector(".account__name"),document.querySelector(".account__description"),document.querySelector(".popup__account-name")),i=document.querySelector(".popup__account-about"),a=document.querySelector(".popup__edit-form"),l=document.querySelector(".account__add-button"),c=(document.querySelector(".popup__place-name"),document.querySelector(".js-input-type-place-url"),document.querySelector(".popup__place-form")),u=document.querySelector(".account__image-edit-btn"),h=document.querySelector(".popup__edit-account-pic-form"),_=document.querySelector(".cards__list"),d={formSelector:".popup__form",inputSelector:".popup__form-input",saveButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input-type-error",errorClass:"popup__error_visible"};let p;const m=new class extends t{constructor(e,t){let{loadingButtonText:s="Saving..."}=t;super(e),this._form=this._popup.querySelector(".popup__form"),this._saveButton=this._form.querySelector(".popup__button"),this._saveButtonText=this._saveButton.textContent,this._loadingButtonText=s}open(e){this._handleSubmit=e,super.open()}close(){super.close()}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit()}))}renderSaving(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._loadingButtonText;this._saveButton.textContent=e?t:this._saveButtonText}}("#delete-popup",{loadingButtonText:"Deleting..."});m.setEventListeners();const v=e=>{const t=B(e);S.addItem(t)},S=new class{constructor(e,t){let{items:s,renderer:n}=e;this._renderedItems=s,this._renderer=n,this._container=t}addItem(e){this._container.prepend(e)}renderItems(e){e.forEach(this._renderer)}}({renderer:v},_),g=new class extends t{constructor(e){super(e),this._cardImage=document.querySelector(".popup__image-preview")}open(e,t){const s=this._cardImage;s.src=t,s.alt=e,document.querySelector(".popup__preview-name").textContent=e,super.open()}}("#view__image"),E=new s("#add__place",{handleFormSubmit:e=>{x(e)}},{loadingButtonText:"Saving..."});l.addEventListener("click",(()=>{E.open(),C.resetValidation()}));const b=new class{constructor(e){let{nameSelector:t,jobSelector:s,accountPicSelector:n}=e;this._name=document.querySelector(t),this._about=document.querySelector(s),this._accountPic=document.querySelector(n)}getUserInfo(){return{name:this._name.textContent,about:this._about.textContent}}setUserInfo(e){let{name:t,about:s}=e;this._name.textContent=t,this._about.textContent=s}setUserAvatar(e){let{avatar:t}=e;this._accountPic.src=t}}({nameSelector:".account__name",jobSelector:".account__description",accountPicSelector:".account__image"}),f=new s("#account__edit",{handleFormSubmit:e=>{q(e)}},{loadingButtonText:"Saving..."});r.addEventListener("click",(()=>{const{name:e,about:t}=b.getUserInfo();o.value=e,i.value=t,f.open(),y.resetValidation()}));const L=new s("#edit-account-pic-popup",{handleFormSubmit:e=>{w(e)}},{loadingButtonText:"Updating image..."});L.setEventListeners(),u.addEventListener("click",(()=>{L.open(),k.resetValidation()}));const y=new n(d,a),C=new n(d,c),k=new n(d,h);f.setEventListeners(),E.setEventListeners(),g.setEventListeners();const B=e=>{const t=new class{constructor(e,t,s,n,r,o){this.handleCardClick=s,this._handleDeleteButton=n,this._cardSelector=t,this._handleLikeButton=r,this._name=e.name,this._link=e.link,this._likes=e.likes,this._ownerId=e.owner._id,this._id=e._id,this._userId=o}updateLikes(e){this._likes=e,this._renderLikes()}isLiked(){return this._likes.some((e=>e._id===this._userId))}_renderLikes(){this._likesTotal.textContent=this._likes.length,this.isLiked()?this._cardElement.querySelector(".card__place-favorite").classList.add("card__place-favorite_active"):this._cardElement.querySelector(".card__place-favorite").classList.remove("card__place-favorite_active")}getCardId(){return this._id}_setEventListeners(){this._cardElement.querySelector(".card__place-favorite").addEventListener("click",this._handleLikeButton),this._trashButton.addEventListener("click",(()=>{this._handleDeleteButton(this._cardElement)})),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this.handleCardClick({link:this._link,name:this._name})}))}removeCard(){this._cardElement.remove(),this._cardElement=null}_getTemplate(){return document.querySelector(this._cardSelector).content.firstElementChild.cloneNode(!0)}getView(){this._cardElement=this._getTemplate(),this._cardElement.querySelector(".card__place-name").textContent=this._name;const e=this._cardElement.querySelector(".card__image");return this._likesTotal=this._cardElement.querySelector(".card__place-num"),this._trashButton=this._cardElement.querySelector(".card__trash"),this._setEventListeners(),this._renderLikes(),e.src=this._link,e.alt=this._name,this._ownerId!==this._userId&&this._trashButton.remove(),this._cardElement}}(e,"#card-template",(()=>{var t;t=e,g.open(t.name,t.link)}),(()=>{m.open((()=>{T(t)}))}),(()=>{I(t)}),p);return t.getView()},I=t=>{e.toggleLike(t.getCardId(),t.isLiked()).then((e=>{t.updateLikes(e.likes)})).catch((e=>{console.log(e)}))},q=t=>{f.renderSaving(!0),e.setUserInfo(t).then((e=>{b.setUserInfo({name:e.name,about:e.about}),f.close()})).catch((e=>{console.log(e)})).finally((()=>{f.renderSaving(!1)}))},x=t=>{E.renderSaving(!0),e.addCard(t).then((e=>{v(e),E.close()})).catch((e=>{console.log(e)})).finally((()=>{E.renderSaving(!1)}))},w=t=>{L.renderSaving(!0),e.updateAccountPic(t).then((e=>{b.setUserAvatar({avatar:e.avatar}),L.close()})).catch((e=>{console.log(e)})).finally((()=>{L.renderSaving(!1)}))},T=t=>{m.renderSaving(!0),e.deleteCard(t.getCardId()).then((()=>{t.removeCard(),m.close()})).catch((e=>{console.log(e)})).finally((()=>{m.renderSaving(!1)}))};e.initialize().then((e=>{let[t,s]=e;p=t._id,S.renderItems(s),b.setUserInfo({name:t.name,about:t.about}),b.setUserAvatar({avatar:t.avatar})})).catch((e=>{console.log(e)})),C.enableValidation(),y.enableValidation(),k.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dkgsR0FDWDJJLEVBQWdCbEcsT0FBTyxJQUV4QnFKLE9BQU1DLElBQ0xDLFFBQVFDLElBQUlGLEVBQUksSUFFakJJLFNBQVEsS0FDUHhELEVBQWdCcEUsY0FBYSxFQUFNLEdBQ25DLEVBRUFvRixFQUFxQjBDLElBQ3pCM0MsRUFBa0JuRixjQUFhLEdBQy9CL0UsRUFBQUEsaUJBQ29CNk0sR0FDakIxTCxNQUFLMEwsSUFDSnZELEVBQVNRLGNBQWMsQ0FDckIzSCxPQUFRMEssRUFBZ0IxSyxTQUUxQitILEVBQWtCakgsT0FBTyxJQUUxQnFKLE9BQU1DLElBQ0xDLFFBQVFDLElBQUlGLEVBQUksSUFFakJJLFNBQVEsS0FDUHpDLEVBQWtCbkYsY0FBYSxFQUFNLEdBQ3JDLEVBRUFxSCxFQUEyQjlCLElBQy9CMUMsRUFBa0I3QyxjQUFhLEdBQy9CL0UsRUFBQUEsV0FDY3NLLEVBQUtxQixhQUNoQnhLLE1BQUssS0FDSm1KLEVBQUt1QixhQUNMakUsRUFBa0IzRSxPQUFPLElBRTFCcUosT0FBTUMsSUFDTEMsUUFBUUMsSUFBSUYsRUFBSSxJQUVqQkksU0FBUSxLQUNQL0UsRUFBa0I3QyxjQUFhLEVBQU0sR0FDckMsRUFFTi9FLEVBQUFBLGFBRUdtQixNQUFLLElBQXVCLElBQXJCMkwsRUFBTUMsR0FBVSxFQUN0QnBGLEVBQVNtRixFQUFLM0IsSUFDZGhELEVBQVNVLFlBQVlrRSxHQUNyQnpELEVBQVNsSSxZQUFZLENBQ25CQyxLQUFNeUwsRUFBS3pMLEtBQ1hDLE1BQU93TCxFQUFLeEwsUUFFZGdJLEVBQVNRLGNBQWMsQ0FDckIzSCxPQUFRMkssRUFBSzNLLFFBQ2IsSUFFSG1LLE9BQU1DLElBQ0xDLFFBQVFDLElBQUlGLEVBQUksSUFHcEJsRCxFQUFvQnJDLG1CQUNwQmlELEVBQXFCakQsbUJBQ3JCb0QsRUFBd0JwRCxrQiIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhWZXJpZmljYXRpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gIH1cblxuICBfaGFuZGxlUmVzcG9uc2UocmVzKSB7XG4gICAgcmV0dXJuIHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgfVxuXG4gIGluaXRpYWxpemUoKSB7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFtcbiAgICAgIHRoaXMuZ2V0VXNlcigpLCBcbiAgICAgIHRoaXMuZ2V0SW5pdGlhbENhcmRzKClcbiAgICBdKTtcbiAgICBcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzKSk7XG4gIH1cblxuICBnZXRVc2VyKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXMpKTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgYWJvdXQ6IGFib3V0LFxuICAgICAgfSksXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXMpKTtcbiAgfVxuXG4gIGFkZENhcmQoeyBuYW1lLCBsaW5rIH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgbGluazogbGluayxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzKSk7XG4gIH1cblxuICBkZWxldGVDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzKSk7XG4gIH1cblxuICB0b2dnbGVMaWtlKGlkLCBpc0xpa2VkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7aWR9YCwge1xuICAgICAgbWV0aG9kOiBpc0xpa2VkID8gXCJERUxFVEVcIiA6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzKSk7XG4gIH1cbiAgdXBkYXRlQWNjb3VudFBpYyh7IGF2YXRhciB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYXZhdGFyLFxuICAgICAgfSksXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXMpKTtcbiAgfVxuXG4gXG59XG5cbmV4cG9ydCBjb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcIjA5OTk4OWY3LTk3NDItNDZlZi05OWY4LWFhOGU2ODcyYTZjM1wiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX2Nsb3NlUG9wdXBPblJlbW90ZUNsaWNrID0gdGhpcy5fY2xvc2VQb3B1cE9uUmVtb3RlQ2xpY2suYmluZCh0aGlzKTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5cIik7XG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9jbG9zZVBvcHVwT25SZW1vdGVDbGljayk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5cIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIHRoaXMuX3BvcHVwLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5fY2xvc2VQb3B1cE9uUmVtb3RlQ2xpY2spO1xuICB9XG5cbiAgX2Nsb3NlUG9wdXBPblJlbW90ZUNsaWNrKGV2dCkge1xuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwX19vdmVybGF5XCIpKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2xvc2UtYnRuXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuY2xvc2UoKSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3RvcihcbiAgICBwb3B1cFNlbGVjdG9yLFxuICAgIHsgaGFuZGxlRm9ybVN1Ym1pdCB9LFxuICAgIHsgbG9hZGluZ0J1dHRvblRleHQgPSBcIlNhdmluZy4uLlwiIH1cbiAgKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19mb3JtLWlucHV0XCIpO1xuICAgIHRoaXMuX3NhdmVCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2J1dHRvblwiKTtcbiAgICB0aGlzLl9zYXZlQnV0dG9uVGV4dCA9IHRoaXMuX3NhdmVCdXR0b24udGV4dENvbnRlbnQ7XG4gICAgdGhpcy5fbG9hZGluZ0J1dHRvblRleHQgPSBsb2FkaW5nQnV0dG9uVGV4dDtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGV2dCA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgfSk7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3Qgb2JqRGF0YSA9ICB7fVxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKGlucHV0ID0+IHsgXG4gICAgICAgICAgb2JqRGF0YVtpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlOyBcbiAgICB9KTtcbiAgICByZXR1cm4gb2JqRGF0YSBcbiAgfVxuXG4gIHNldElucHV0VmFsdWVzKGRhdGEpIHtcbiAgICB0aGlzLl9vYmpJbnB1dCA9IHt9O1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKGlucHV0ID0+IHtcbiAgICAgIHRoaXMuX29iaklucHV0W2lucHV0Lm5hbWVdID0gZGF0YVtpbnB1dC52YWx1ZV07XG4gICAgfSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG5cbiAgcmVuZGVyU2F2aW5nKGlzU2F2aW5nLCBsb2FkaW5nVGV4dCA9IHRoaXMuX2xvYWRpbmdCdXR0b25UZXh0KSB7XG4gICAgaWYgKGlzU2F2aW5nKSB7XG4gICAgICB0aGlzLl9zYXZlQnV0dG9uLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3NhdmVCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zYXZlQnV0dG9uVGV4dDtcbiAgICB9XG4gIH1cblxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XG5cbmNsYXNzIFBvcHVwV2l0aFZlcmlmaWNhdGlvbiBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgeyBsb2FkaW5nQnV0dG9uVGV4dCA9IFwiU2F2aW5nLi4uXCIgfSkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xuICAgIHRoaXMuX3NhdmVCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2J1dHRvblwiKTtcbiAgICB0aGlzLl9zYXZlQnV0dG9uVGV4dCA9IHRoaXMuX3NhdmVCdXR0b24udGV4dENvbnRlbnQ7XG4gICAgdGhpcy5fbG9hZGluZ0J1dHRvblRleHQgPSBsb2FkaW5nQnV0dG9uVGV4dDtcbiAgfVxuXG4gIG9wZW4oYWN0aW9uKSB7XG4gICAgdGhpcy5faGFuZGxlU3VibWl0ID0gYWN0aW9uO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgZXZ0ID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlU3VibWl0KCk7XG4gICAgfSk7XG4gIH1cblxuICByZW5kZXJTYXZpbmcoaXNTYXZpbmcsIGxvYWRpbmdUZXh0ID0gdGhpcy5fbG9hZGluZ0J1dHRvblRleHQpIHtcbiAgICBpZiAoaXNTYXZpbmcpIHtcbiAgICAgIHRoaXMuX3NhdmVCdXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3NhdmVCdXR0b25UZXh0O1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhWZXJpZmljYXRpb247XG4iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IodmFsaWRhdGlvblNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWxlbWVudDtcblxuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IHZhbGlkYXRpb25TZXR0aW5ncy5mb3JtU2VsZWN0b3I7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHZhbGlkYXRpb25TZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xuICAgIHRoaXMuX3NhdmVCdXR0b25TZWxlY3RvciA9IHZhbGlkYXRpb25TZXR0aW5ncy5zYXZlQnV0dG9uU2VsZWN0b3I7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHZhbGlkYXRpb25TZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHZhbGlkYXRpb25TZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9dmFsaWRhdGlvblNldHRpbmdzLmVycm9yQ2xhc3M7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gWy4uLnRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKV07XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zYXZlQnV0dG9uU2VsZWN0b3IpO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKGlucHV0RWxlbWVudCA9PiB7XG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcbiAgICB9KTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKGlucHV0RWxlbWVudCA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIik7XG4gICAgfVxuICB9XG5cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBmdW5jdGlvbihldnQpIHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaChpbnB1dEVsZW1lbnQgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yOyIsImV4cG9ydCBjb25zdCBlZGl0QWNjb3VudE9wZW5CdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFjY291bnRfX2VkaXQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IGFjY291bnROYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFjY291bnRfX25hbWVcIik7XG5leHBvcnQgY29uc3QgYWNjb3VudFRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFjY291bnRfX2Rlc2NyaXB0aW9uXCIpO1xuZXhwb3J0IGNvbnN0IGFkZFBvcHVwU2VsZWN0b3IgPSBcIiNhZGRfX3BsYWNlXCI7XG5leHBvcnQgY29uc3QgZWRpdFBvcHVwU2VsZWN0b3IgPSBcIiNhY2NvdW50X19lZGl0XCI7XG5leHBvcnQgY29uc3QgYWNjb3VudE5hbWUgPSBcIi5hY2NvdW50X19uYW1lXCI7XG5leHBvcnQgY29uc3QgYWNjb3VudFRpdGxlID0gXCIuYWNjb3VudF9fZGVzY3JpcHRpb25cIjtcblxuZXhwb3J0IGNvbnN0IHBvcHVwQWNjb3VudE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19hY2NvdW50LW5hbWVcIik7XG5leHBvcnQgY29uc3QgcG9wdXBBY2NvdW50SWNvbnNUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2FjY291bnQtYWJvdXRcIik7XG5leHBvcnQgY29uc3QgYWNjb3VudFBpY1NlbGVjdG9yID0gXCIuYWNjb3VudF9faW1hZ2VcIjtcbmV4cG9ydCBjb25zdCBzdWJtaXRBY2NvdW50RWRpdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2VkaXQtZm9ybVwiKTtcbmV4cG9ydCBjb25zdCBhZGRQbGFjZXNPcGVuQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hY2NvdW50X19hZGQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IHBvcHVwUGxhY2VOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fcGxhY2UtbmFtZVwiKTtcbmV4cG9ydCBjb25zdCBwb3B1cFBsYWNlVXJsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5qcy1pbnB1dC10eXBlLXBsYWNlLXVybFwiKTtcbmV4cG9ydCBjb25zdCBzdWJtaXROZXdQbGFjZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX3BsYWNlLWZvcm1cIik7XG5leHBvcnQgY29uc3QgZWRpdEFjY291bnRQaWNCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFjY291bnRfX2ltYWdlLWVkaXQtYnRuXCIpO1xuZXhwb3J0IGNvbnN0IHN1Ym1pdE5ld0FjY291bnRQaWMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19lZGl0LWFjY291bnQtcGljLWZvcm1cIik7XG5cbi8vIENhcmRzIExpc3QgXG5leHBvcnQgY29uc3QgcGxhY2VMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcblxuXG4vLyBQbGFjZSBDYXJkc1xuZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiUmVhY2hpbmcgZm9yIHRoZSBNb29uXCIsXG4gICAgbGluazogXCJodHRwczovL2kucGluaW1nLmNvbS81NjR4Lzg4LzliLzM2Lzg4OWIzNjA3YjJiOTM0MzBiNDBkN2YwM2FlOTE4ZThkLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJQb3J0cmFpdCBvZiBCYXJiYXJhIG9mIFBvcnR1Z2FsXCIsXG4gICAgbGluazogXCJodHRwczovL2kucGluaW1nLmNvbS81NjR4LzhhL2EwLzcwLzhhYTA3MDUzMTc4Y2IxYmJiNGEzZjkzMzc5ZDc1MGQyLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJTaW1lcmVueWFcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaS5waW5pbWcuY29tLzU2NHgvNDYvNjYvMzAvNDY2NjMwNTBlMzg4NTUwYmYyNGI4MDg2MTc5NjI3MWUuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkN1cGlkIGFuZCBQc3ljaGVcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaS5waW5pbWcuY29tLzU2NHgvMTYvZTIvOGIvMTZlMjhiYmI0ODgwODVjZjVkZjY5ZjYyYzA3NzkxY2IuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlN0cmVldCBpbiB0aGUgRXZlbmluZywgUHJhZ3VlXCIsXG4gICAgbGluazogXCJodHRwczovL2kucGluaW1nLmNvbS81NjR4L2ZlLzg1LzNiL2ZlODUzYjEyZWU1MjkwYTRiMDk2N2VjNmUyMGRlNzgyLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJHaXJsIGF0IHRoZSBQaWFub1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9pLnBpbmltZy5jb20vNTY0eC9kNy8wYi81My9kNzBiNTM0NzkxZjUwZjYyZTc0MTY2OWFlY2Q3YTQ3OS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiR29pbmcgSG9tZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9pLnBpbmltZy5jb20vNTY0eC9hZC81My8yYi9hZDUzMmIzMWJiZmNkMDA2YzZiOGYzM2E5YjRjZWJmMy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiUmFpbnkgTmlnaHRcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaS5waW5pbWcuY29tLzU2NHgvMWEvNTAvMzIvMWE1MDMyMWI5MDViNWRkZDYwYjI4MDJjMWI1MGFkNGIuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlRoZSBTcHJlYWRpbmcgVHJlZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9pLnBpbmltZy5jb20vNTY0eC9kNi9iMi9mOS9kNmIyZjk0NjU3OTdjNGFkZWM1ZmNhNjQxYTFkZDJkOC5qcGdcIixcbiAgfSxcbl07XG5cbi8vIFZhbGlkYXRvcnMgXG5cbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uU2V0dGluZ3MgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIucG9wdXBfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2Zvcm0taW5wdXRcIixcbiAgc2F2ZUJ1dHRvblNlbGVjdG9yOiBcIi5wb3B1cF9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwicG9wdXBfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0LXR5cGUtZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJwb3B1cF9fZXJyb3JfdmlzaWJsZVwiXG59O1xuXG5cbiIsIi8vIEluZGV4IENTUyBJbXBvcnRcblxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjsgXG4gXG4vLyBKUyBJbXBvcnRzIFxuaW1wb3J0IHsgYXBpIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7IFxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiOyBcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjsgXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjsgXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7IFxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7IFxuaW1wb3J0IFBvcHVwV2l0aFZlcmlmaWNhdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhWZXJpZmljYXRpb24uanNcIjsgXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7IFxuaW1wb3J0IHsgXG4gIGVkaXRBY2NvdW50T3BlbkJ0biwgXG4gIGFjY291bnROYW1lLCBcbiAgYWNjb3VudFRpdGxlLCBcbiAgc3VibWl0QWNjb3VudEVkaXQsIFxuICBhZGRQbGFjZXNPcGVuQnRuLCBcbiAgZWRpdEFjY291bnRQaWNCdXR0b24sIFxuICBhY2NvdW50UGljU2VsZWN0b3IsIFxuICBwb3B1cFBsYWNlTmFtZSwgXG4gIHBvcHVwUGxhY2VVcmwsIFxuICBwb3B1cEFjY291bnROYW1lLCBcbiAgc3VibWl0TmV3QWNjb3VudFBpYywgXG4gIGFjY291bnROYW1lSW5wdXQsIFxuICBwb3B1cEFjY291bnRJY29uc1RpdGxlLCBcbiAgYWNjb3VudFRpdGxlSW5wdXQsIFxuICBzdWJtaXROZXdQbGFjZSwgXG4gIGVkaXRQb3B1cFNlbGVjdG9yLCBcbiAgcGxhY2VMaXN0LFxuXG4gIGFkZFBvcHVwU2VsZWN0b3IsIFxuICB2YWxpZGF0aW9uU2V0dGluZ3NcblxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7IFxuXG5sZXQgdXNlcklkOyBcblxuXG4vLyBDYXJkIEZ1bmN0aW9ucyBcbmNvbnN0IGNvbmZpcm1hdGlvblBvcHVwID0gbmV3IFBvcHVwV2l0aFZlcmlmaWNhdGlvbihcIiNkZWxldGUtcG9wdXBcIiwgeyBcbiAgbG9hZGluZ0J1dHRvblRleHQ6IFwiRGVsZXRpbmcuLi5cIiBcbn0pOyBcbmNvbmZpcm1hdGlvblBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7IFxuXG4gXG5jb25zdCByZW5kZXJDYXJkID0gY2FyZERhdGFQbGFjZUhvbGRlciA9PiB7IFxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoY2FyZERhdGFQbGFjZUhvbGRlcik7IFxuICBjYXJkTGlzdC5hZGRJdGVtKGNhcmRFbGVtZW50KTsgXG59OyBcbiBcbmNvbnN0IGNhcmRMaXN0ID0gbmV3IFNlY3Rpb24oIFxuICB7IFxuICAgIHJlbmRlcmVyOiByZW5kZXJDYXJkIFxuICB9LCBcbiAgcGxhY2VMaXN0IFxuKTsgXG4gXG4gXG5jb25zdCBwcmV2aWV3SW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiN2aWV3X19pbWFnZVwiKTsgXG5jb25zdCBoYW5kbGVDYXJkQ2xpY2sgPSBpdGVtID0+IHsgXG4gIHByZXZpZXdJbWFnZVBvcHVwLm9wZW4oaXRlbS5uYW1lLCBpdGVtLmxpbmspOyBcbn07IFxuIFxuY29uc3QgYWRkTmV3Q2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oIFxuICBhZGRQb3B1cFNlbGVjdG9yLCBcbiAgeyBcbiAgICBoYW5kbGVGb3JtU3VibWl0OiBkYXRhID0+IHsgXG4gICAgICBhZGRBQ2FyZChkYXRhKTsgXG4gICAgfSBcbiAgfSwgXG4gIHsgXG4gICAgbG9hZGluZ0J1dHRvblRleHQ6IFwiU2F2aW5nLi4uXCIgXG4gfSBcbik7IFxuIFxuYWRkUGxhY2VzT3BlbkJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4geyBcbiBhZGROZXdDYXJkUG9wdXAub3BlbigpOyBcbiAgcGxhY2VzRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTsgXG59KTsgXG4gXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7IFxuICBuYW1lU2VsZWN0b3I6IGFjY291bnROYW1lLCBcbiAgam9iU2VsZWN0b3I6IGFjY291bnRUaXRsZSwgXG4gIGFjY291bnRQaWNTZWxlY3RvcjogYWNjb3VudFBpY1NlbGVjdG9yIFxufSk7IFxuIFxuLy8gUG9wdXAgRnVuY3Rpb25zIFxuY29uc3QgZWRpdEZvcm1Qb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKCBcbiAgZWRpdFBvcHVwU2VsZWN0b3IsIFxuICB7IFxuICAgIGhhbmRsZUZvcm1TdWJtaXQ6IGRhdGEgPT4geyBcbiAgICAgIGVkaXRBY2NvdW50KGRhdGEpOyBcbiAgICB9IFxuICB9LCBcbiAgeyBcbiAgICBsb2FkaW5nQnV0dG9uVGV4dDogXCJTYXZpbmcuLi5cIiBcbiAgfSBcbik7IFxuZWRpdEFjY291bnRPcGVuQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7IFxuICBjb25zdCB7IG5hbWUsIGFib3V0IH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpOyBcbiAgcG9wdXBBY2NvdW50TmFtZS52YWx1ZSA9IG5hbWU7IFxuICBwb3B1cEFjY291bnRJY29uc1RpdGxlLnZhbHVlID0gYWJvdXQ7IFxuXG4gIGVkaXRGb3JtUG9wdXAub3BlbigpOyBcbiAgYWNjb3VudEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7IFxufSk7IFxuY29uc3QgZWRpdFBvZmlsZVBpY0Zvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybSggXG4gIFwiI2VkaXQtYWNjb3VudC1waWMtcG9wdXBcIiwgXG4gIHsgXG4gICAgaGFuZGxlRm9ybVN1Ym1pdDogZGF0YSA9PiB7IFxuICAgICAgY2hhbmdlQWNjb3VudEltYWdlKGRhdGEpOyBcbiAgICB9IFxuICB9LCBcbiAgeyBcbiAgICBsb2FkaW5nQnV0dG9uVGV4dDogXCJVcGRhdGluZyBpbWFnZS4uLlwiIFxuICB9IFxuKTsgXG4gXG5lZGl0UG9maWxlUGljRm9ybS5zZXRFdmVudExpc3RlbmVycygpOyBcbmVkaXRBY2NvdW50UGljQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7IFxuICBlZGl0UG9maWxlUGljRm9ybS5vcGVuKCk7IFxuICBhY2NvdW50UGljRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTsgXG59KTsgXG4gXG5jb25zdCBhY2NvdW50Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKCBcbiAgdmFsaWRhdGlvblNldHRpbmdzLCBcbiAgc3VibWl0QWNjb3VudEVkaXQgXG4pOyBcbmNvbnN0IHBsYWNlc0Zvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uU2V0dGluZ3MsIHN1Ym1pdE5ld1BsYWNlKTsgXG4gXG5jb25zdCBhY2NvdW50UGljRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKCBcbiAgdmFsaWRhdGlvblNldHRpbmdzLCBcbiAgc3VibWl0TmV3QWNjb3VudFBpYyBcbik7IFxuIFxuZWRpdEZvcm1Qb3B1cC5zZXRFdmVudExpc3RlbmVycygpOyBcbmFkZE5ld0NhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpOyBcbiBcbnByZXZpZXdJbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7IFxuIFxuY29uc3QgY3JlYXRlQ2FyZCA9IGNhcmREYXRhUGxhY2VIb2xkZXIgPT4geyBcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKCBcbiAgICBjYXJkRGF0YVBsYWNlSG9sZGVyLCBcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsIFxuICAgICgpID0+IHsgXG5cbiAgICAgIGhhbmRsZUNhcmRDbGljayhjYXJkRGF0YVBsYWNlSG9sZGVyKTtcbiAgICB9LCBcbiAgICAoKSA9PiB7IFxuICAgICAgY29uZmlybWF0aW9uUG9wdXAub3BlbigoKSA9PiB7XG4gICAgICAgIGhhbmRsZURlbGV0ZUNvbmZpcm1hdGlvbihjYXJkKTsgXG4gICAgICB9KTsgXG4gICAgfSwgXG4gICAgKCkgPT4geyBcbiAgICAgIHRvZ2dsZUxpa2UoY2FyZCk7IFxuICAgIH0sIFxuICAgIHVzZXJJZCBcbiAgKTsgXG4gIHJldHVybiBjYXJkLmdldFZpZXcoKTsgXG59OyBcbiBcbmNvbnN0IHRvZ2dsZUxpa2UgPSBjYXJkUGxhY2Vob2xkZXIgPT4geyBcbiAgYXBpIFxuICAgIC50b2dnbGVMaWtlKGNhcmRQbGFjZWhvbGRlci5nZXRDYXJkSWQoKSwgY2FyZFBsYWNlaG9sZGVyLmlzTGlrZWQoKSkgXG4gICAgLnRoZW4obGlrZXMgPT4geyBcbiAgICAgIGNhcmRQbGFjZWhvbGRlci51cGRhdGVMaWtlcyhsaWtlcy5saWtlcyk7IFxuICAgIH0pIFxuICAgIC5jYXRjaChlcnIgPT4geyBcbiAgICAgIGNvbnNvbGUubG9nKGVycik7IFxuICAgIH0pOyBcbn07IFxuY29uc3QgZWRpdEFjY291bnQgPSBhY2NvdW50RGF0YSA9PiB7IFxuICBlZGl0Rm9ybVBvcHVwLnJlbmRlclNhdmluZyh0cnVlKTsgXG4gIGFwaSBcbiAgICAuc2V0VXNlckluZm8oYWNjb3VudERhdGEpIFxuICAgIC50aGVuKGFjY291bnREYXRhID0+IHsgXG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7IFxuICAgICAgICBuYW1lOiBhY2NvdW50RGF0YS5uYW1lLCBcbiAgICAgICAgYWJvdXQ6IGFjY291bnREYXRhLmFib3V0IFxuICAgICAgfSk7IFxuICAgICAgZWRpdEZvcm1Qb3B1cC5jbG9zZSgpOyBcbiAgICB9KSBcbiAgICAuY2F0Y2goZXJyID0+IHsgXG4gICAgICBjb25zb2xlLmxvZyhlcnIpOyBcbiAgICB9KSBcbiAgICAuZmluYWxseSgoKSA9PiB7IFxuICAgICAgZWRpdEZvcm1Qb3B1cC5yZW5kZXJTYXZpbmcoZmFsc2UpOyBcbiAgICB9KTsgXG59OyBcbmNvbnN0IGFkZEFDYXJkID0gY2FyZERhdGFQbGFjZWhvbGRlciA9PiB7IFxuICBhZGROZXdDYXJkUG9wdXAucmVuZGVyU2F2aW5nKHRydWUpOyBcbiAgYXBpIFxuICAgIC5hZGRDYXJkKGNhcmREYXRhUGxhY2Vob2xkZXIpIFxuICAgIC50aGVuKHJlcyA9PiB7IFxuICAgICAgcmVuZGVyQ2FyZChyZXMpOyBcbiAgICAgIGFkZE5ld0NhcmRQb3B1cC5jbG9zZSgpOyBcbiAgICB9KSBcbiAgICAuY2F0Y2goZXJyID0+IHsgXG4gICAgICBjb25zb2xlLmxvZyhlcnIpOyBcbiAgICB9KSBcbiAgICAuZmluYWxseSgoKSA9PiB7IFxuICAgICAgYWRkTmV3Q2FyZFBvcHVwLnJlbmRlclNhdmluZyhmYWxzZSk7IFxuICAgIH0pOyBcbn07IFxuY29uc3QgY2hhbmdlQWNjb3VudEltYWdlID0gYWNjb3VudEltYWdlVXJsID0+IHsgXG4gIGVkaXRQb2ZpbGVQaWNGb3JtLnJlbmRlclNhdmluZyh0cnVlKTsgXG4gIGFwaSBcbiAgICAudXBkYXRlQWNjb3VudFBpYyhhY2NvdW50SW1hZ2VVcmwpIFxuICAgIC50aGVuKGFjY291bnRJbWFnZVVybCA9PiB7IFxuICAgICAgdXNlckluZm8uc2V0VXNlckF2YXRhcih7IFxuICAgICAgICBhdmF0YXI6IGFjY291bnRJbWFnZVVybC5hdmF0YXIgXG4gICAgICB9KTsgXG4gICAgICBlZGl0UG9maWxlUGljRm9ybS5jbG9zZSgpOyBcbiAgICB9KSBcbiAgICAuY2F0Y2goZXJyID0+IHsgXG4gICAgICBjb25zb2xlLmxvZyhlcnIpOyBcbiAgICB9KSBcbiAgICAuZmluYWxseSgoKSA9PiB7IFxuICAgICAgZWRpdFBvZmlsZVBpY0Zvcm0ucmVuZGVyU2F2aW5nKGZhbHNlKTsgXG4gICAgfSk7IFxufTsgXG5jb25zdCBoYW5kbGVEZWxldGVDb25maXJtYXRpb24gPSBjYXJkID0+IHsgXG4gIGNvbmZpcm1hdGlvblBvcHVwLnJlbmRlclNhdmluZyh0cnVlKTsgXG4gIGFwaSBcbiAgICAuZGVsZXRlQ2FyZChjYXJkLmdldENhcmRJZCgpKSBcbiAgICAudGhlbigoKSA9PiB7IFxuICAgICAgY2FyZC5yZW1vdmVDYXJkKCk7IFxuICAgICAgY29uZmlybWF0aW9uUG9wdXAuY2xvc2UoKTsgXG4gICAgfSkgXG4gICAgLmNhdGNoKGVyciA9PiB7IFxuICAgICAgY29uc29sZS5sb2coZXJyKTsgXG4gICAgfSkgXG4gICAgLmZpbmFsbHkoKCkgPT4geyBcbiAgICAgIGNvbmZpcm1hdGlvblBvcHVwLnJlbmRlclNhdmluZyhmYWxzZSk7IFxuICAgIH0pOyBcbn07IFxuYXBpIFxuICAuaW5pdGlhbGl6ZSgpIFxuICAudGhlbigoW3VzZXIsIGNhcmRzRGF0YV0pID0+IHsgXG4gICAgdXNlcklkID0gdXNlci5faWQ7IFxuICAgIGNhcmRMaXN0LnJlbmRlckl0ZW1zKGNhcmRzRGF0YSk7IFxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHsgXG4gICAgICBuYW1lOiB1c2VyLm5hbWUsIFxuICAgICAgYWJvdXQ6IHVzZXIuYWJvdXQgXG4gICAgfSk7IFxuICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIoeyBcbiAgICAgIGF2YXRhcjogdXNlci5hdmF0YXIgXG4gICAgfSk7IFxuICB9KSBcbiAgLmNhdGNoKGVyciA9PiB7IFxuICAgIGNvbnNvbGUubG9nKGVycik7IFxuICB9KTsgXG4gXG5wbGFjZXNGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTsgXG5hY2NvdW50Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7IFxuYWNjb3VudFBpY0Zvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpOyAiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyKSB7XG4gICAgdGhpcy5fcmVuZGVyZWRJdGVtcyA9IGl0ZW1zOyBcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgfVxuXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoaXRlbXMpIHtcbiAgICBpdGVtcy5mb3JFYWNoKHRoaXMuX3JlbmRlcmVyKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fY2FyZEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2UtcHJldmlld1wiKTtcbiAgfVxuICBvcGVuKG5hbWUsIGxpbmspIHtcbiAgICBjb25zdCBpbWFnZUVsZW1lbnQgPSB0aGlzLl9jYXJkSW1hZ2U7XG4gICAgaW1hZ2VFbGVtZW50LnNyYyA9IGxpbms7XG4gICAgaW1hZ2VFbGVtZW50LmFsdCA9IG5hbWU7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLnBvcHVwX19wcmV2aWV3LW5hbWVcIlxuICAgICkudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhJbWFnZTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yLGFjY291bnRQaWNTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9hYm91dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xuICAgIHRoaXMuX2FjY291bnRQaWMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGFjY291bnRQaWNTZWxlY3Rvcik7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4geyBcbiAgICAgIG5hbWU6IHRoaXMuX25hbWUudGV4dENvbnRlbnQsIFxuICAgICAgYWJvdXQ6IHRoaXMuX2Fib3V0LnRleHRDb250ZW50IFxuICAgIH1cbiAgfVxuXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX2Fib3V0LnRleHRDb250ZW50ID0gYWJvdXQ7XG4gIH1cblxuICBzZXRVc2VyQXZhdGFyKHthdmF0YXJ9KXtcbiAgICB0aGlzLl9hY2NvdW50UGljLnNyYyA9IGF2YXRhcjtcbiAgfVxufVxuIiwiY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIGRhdGEsXG4gICAgY2FyZFNlbGVjdG9yLFxuICAgIGhhbmRsZUNhcmRDbGljayxcbiAgICBoYW5kbGVEZWxldGVCdXR0b24sXG4gICAgaGFuZGxlTGlrZUJ1dHRvbixcbiAgICB1c2VySWRcbiAgKSB7XG4gICAgdGhpcy5oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQnV0dG9uID0gaGFuZGxlRGVsZXRlQnV0dG9uO1xuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uID0gaGFuZGxlTGlrZUJ1dHRvbjtcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xuICAgIHRoaXMuX293bmVySWQgPSBkYXRhLm93bmVyLl9pZDtcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcbiAgfVxuXG4gIHVwZGF0ZUxpa2VzKGxpa2VzKSB7XG4gICAgdGhpcy5fbGlrZXMgPSBsaWtlcztcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xuICB9XG5cbiAgaXNMaWtlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5fbGlrZXMuc29tZShsaWtlID0+IGxpa2UuX2lkID09PSB0aGlzLl91c2VySWQpO1xuICB9XG5cbiAgX3JlbmRlckxpa2VzKCkge1xuICAgIHRoaXMuX2xpa2VzVG90YWwudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XG4gICAgaWYgKHRoaXMuaXNMaWtlZCgpKSB7XG4gICAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19wbGFjZS1mYXZvcml0ZVwiKVxuICAgICAgICAuY2xhc3NMaXN0LmFkZChcImNhcmRfX3BsYWNlLWZhdm9yaXRlX2FjdGl2ZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fcGxhY2UtZmF2b3JpdGVcIilcbiAgICAgICAgLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19wbGFjZS1mYXZvcml0ZV9hY3RpdmVcIik7XG4gICAgfVxuICB9XG5cbiAgZ2V0Q2FyZElkKCkge1xuICAgIHJldHVybiB0aGlzLl9pZDtcbiAgfVxuICAvL3J1bnMgM3JkXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fcGxhY2UtZmF2b3JpdGVcIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbik7XG5cbiAgICB0aGlzLl90cmFzaEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQnV0dG9uKHRoaXMuX2NhcmRFbGVtZW50KTtcbiAgICB9KTtcblxuICAgIHRoaXMuX2NhcmRFbGVtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuaGFuZGxlQ2FyZENsaWNrKHsgbGluazogdGhpcy5fbGluaywgbmFtZTogdGhpcy5fbmFtZSB9KTtcbiAgICAgIH0pO1xuICB9XG5cbiAgcmVtb3ZlQ2FyZCgpIHsgXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7IFxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbFxufSBcblxuICAvL3J1bnMgMm5kXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICByZXR1cm4gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LmZpcnN0RWxlbWVudENoaWxkLmNsb25lTm9kZSh0cnVlKTsgLy8vX2dldFRlbXBsYXRlXG4gIH1cbiAgLy9ydW5zIDFzdFxuICBnZXRWaWV3KCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIuY2FyZF9fcGxhY2UtbmFtZVwiXG4gICAgKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG4gICAgY29uc3QgaW1hZ2VFbGVtZW50ID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgICB0aGlzLl9saWtlc1RvdGFsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19wbGFjZS1udW1cIik7XG4gICAgdGhpcy5fdHJhc2hCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RyYXNoXCIpO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcbiAgICBpbWFnZUVsZW1lbnQuc3JjID0gdGhpcy5fbGluaztcbiAgICBpbWFnZUVsZW1lbnQuYWx0ID0gdGhpcy5fbmFtZTtcbiAgICBpZiAodGhpcy5fb3duZXJJZCAhPT0gdGhpcy5fdXNlcklkKSB7XG4gICAgICB0aGlzLl90cmFzaEJ1dHRvbi5yZW1vdmUoKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IENhcmQ7XG4iXSwibmFtZXMiOlsiYXBpIiwiY29uc3RydWN0b3IiLCJiYXNlVXJsIiwiaGVhZGVycyIsInRoaXMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2hhbmRsZVJlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImluaXRpYWxpemUiLCJhbGwiLCJnZXRVc2VyIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJ0aGVuIiwic2V0VXNlckluZm8iLCJuYW1lIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFkZENhcmQiLCJsaW5rIiwiZGVsZXRlQ2FyZCIsImNhcmRJZCIsInRvZ2dsZUxpa2UiLCJpZCIsImlzTGlrZWQiLCJ1cGRhdGVBY2NvdW50UGljIiwiYXZhdGFyIiwiYXV0aG9yaXphdGlvbiIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJfY2xvc2VQb3B1cE9uUmVtb3RlQ2xpY2siLCJvcGVuIiwiY2xhc3NMaXN0IiwiYWRkIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNsb3NlIiwicmVtb3ZlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2dCIsInRhcmdldCIsImNvbnRhaW5zIiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsImxvYWRpbmdCdXR0b25UZXh0Iiwic3VwZXIiLCJfZm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2lucHV0TGlzdCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc2F2ZUJ1dHRvbiIsIl9zYXZlQnV0dG9uVGV4dCIsInRleHRDb250ZW50IiwiX2xvYWRpbmdCdXR0b25UZXh0IiwicHJldmVudERlZmF1bHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJvYmpEYXRhIiwiZm9yRWFjaCIsImlucHV0IiwidmFsdWUiLCJzZXRJbnB1dFZhbHVlcyIsImRhdGEiLCJfb2JqSW5wdXQiLCJyZXNldCIsInJlbmRlclNhdmluZyIsImlzU2F2aW5nIiwibG9hZGluZ1RleHQiLCJ2YWxpZGF0aW9uU2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsIl9mb3JtU2VsZWN0b3IiLCJmb3JtU2VsZWN0b3IiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc2F2ZUJ1dHRvblNlbGVjdG9yIiwic2F2ZUJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9idXR0b25FbGVtZW50IiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwiX2hpZGVJbnB1dEVycm9yIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJzb21lIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwic2V0QXR0cmlidXRlIiwicmVtb3ZlQXR0cmlidXRlIiwiZW5hYmxlVmFsaWRhdGlvbiIsInJlc2V0VmFsaWRhdGlvbiIsImVkaXRBY2NvdW50T3BlbkJ0biIsInBvcHVwQWNjb3VudE5hbWUiLCJwb3B1cEFjY291bnRJY29uc1RpdGxlIiwic3VibWl0QWNjb3VudEVkaXQiLCJhZGRQbGFjZXNPcGVuQnRuIiwic3VibWl0TmV3UGxhY2UiLCJlZGl0QWNjb3VudFBpY0J1dHRvbiIsInN1Ym1pdE5ld0FjY291bnRQaWMiLCJwbGFjZUxpc3QiLCJ1c2VySWQiLCJjb25maXJtYXRpb25Qb3B1cCIsImFjdGlvbiIsIl9oYW5kbGVTdWJtaXQiLCJyZW5kZXJDYXJkIiwiY2FyZERhdGFQbGFjZUhvbGRlciIsImNhcmRFbGVtZW50IiwiY3JlYXRlQ2FyZCIsImNhcmRMaXN0IiwiYWRkSXRlbSIsImNvbnRhaW5lciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfcmVuZGVyZWRJdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJlbGVtZW50IiwicHJlcGVuZCIsInJlbmRlckl0ZW1zIiwicHJldmlld0ltYWdlUG9wdXAiLCJfY2FyZEltYWdlIiwiaW1hZ2VFbGVtZW50Iiwic3JjIiwiYWx0IiwiYWRkTmV3Q2FyZFBvcHVwIiwiYWRkQUNhcmQiLCJwbGFjZXNGb3JtVmFsaWRhdG9yIiwidXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsImFjY291bnRQaWNTZWxlY3RvciIsIl9uYW1lIiwiX2Fib3V0IiwiX2FjY291bnRQaWMiLCJnZXRVc2VySW5mbyIsInNldFVzZXJBdmF0YXIiLCJlZGl0Rm9ybVBvcHVwIiwiZWRpdEFjY291bnQiLCJhY2NvdW50Rm9ybVZhbGlkYXRvciIsImVkaXRQb2ZpbGVQaWNGb3JtIiwiY2hhbmdlQWNjb3VudEltYWdlIiwiYWNjb3VudFBpY0Zvcm1WYWxpZGF0b3IiLCJGb3JtVmFsaWRhdG9yIiwiY2FyZCIsImNhcmRTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZURlbGV0ZUJ1dHRvbiIsImhhbmRsZUxpa2VCdXR0b24iLCJfaGFuZGxlRGVsZXRlQnV0dG9uIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVMaWtlQnV0dG9uIiwiX2xpbmsiLCJfbGlrZXMiLCJsaWtlcyIsIl9vd25lcklkIiwib3duZXIiLCJfaWQiLCJfdXNlcklkIiwidXBkYXRlTGlrZXMiLCJfcmVuZGVyTGlrZXMiLCJsaWtlIiwiX2xpa2VzVG90YWwiLCJsZW5ndGgiLCJfY2FyZEVsZW1lbnQiLCJnZXRDYXJkSWQiLCJfdHJhc2hCdXR0b24iLCJyZW1vdmVDYXJkIiwiX2dldFRlbXBsYXRlIiwiY29udGVudCIsImZpcnN0RWxlbWVudENoaWxkIiwiY2xvbmVOb2RlIiwiZ2V0VmlldyIsIml0ZW0iLCJoYW5kbGVEZWxldGVDb25maXJtYXRpb24iLCJjYXJkUGxhY2Vob2xkZXIiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJhY2NvdW50RGF0YSIsImZpbmFsbHkiLCJjYXJkRGF0YVBsYWNlaG9sZGVyIiwiYWNjb3VudEltYWdlVXJsIiwidXNlciIsImNhcmRzRGF0YSJdLCJzb3VyY2VSb290IjoiIn0=